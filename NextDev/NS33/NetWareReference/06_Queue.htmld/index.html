<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<html>
<!-- Created with LatinByrd III -->
<!-- File: /NextLibrary/Documentation/Novell/NetWareReference/06_Queue.rtf -->
<!-- Date: Mon Jan  9 04:04:03 2023 -->
<head>
<title>06_Queue</title>
</head>

<body bgcolor="#FFFFFF" text="#000000" link="#0000FF" alink="#FF00FF" vlink="#FF0000">

<basefont size=3>

<p><font face="Times">Copyright</font> &copy;<font face="Times">1993 by Novell, Inc. and NeXT Computer, Inc.&nbsp; All Rights Reserved.</font>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=5></td>

<td><font face="Times" size="+4">Queue Management Services APIs</font>

<p><br><br>

<p><font face="Helvetica" size="+1"><b>Introduction to QMS</b></font></td></tr>

</table>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=55></td>

<td><font face="Times" size="+1">Queue Management Services (QMS) allow an application to create queues for controlling the flow of jobs and services on the network.&nbsp; A queue organizes client requests for a job server.&nbsp; A job server is software that resides at a specific workstation and provides services for other workstations on the network.&nbsp; Networks can have many different kinds of job servers, including print servers, archiving servers, compiling servers, message-sending servers and so on.&nbsp; By placing requests into network queues, a job server can provide service that is both flexible and efficient.</font>

<p><font face="Times" size="+1">Some of the function calls in this chapter would only be called by a queue server.&nbsp; Others might be called by user applications which submit queue jobs and maintain created queues.</font></td></tr>

</table>

<p><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=5></td>

<td><font face="Helvetica" size="+1"><b>NWAbortServicingQueueJob</b></font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=55></td>

<td><font face="Times" size="+1">This function signals the queue management software that a job cannot be completed successfully.</font></td></tr>

</table>

<p><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=5></td>

<td><font face="Helvetica" size="+1"><b>Synopsis</b></font></td></tr>

</table>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=55></td>

<td><font face="Times" size="+1">#include &#34;netware/nwapi.h&#34;</font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=55></td>

<td nowrap><font face="Times" size="+1">int</font></td>

<td><font face="Times" size="+1">ccode;</font></td></tr>

<tr valign=top>

<td width=55></td>

<td nowrap><font face="Times" size="+1">uint16</font></td>

<td><font face="Times" size="+1">serverConnID;</font></td></tr>

<tr valign=top>

<td width=55></td>

<td nowrap><font face="Times" size="+1">uint32</font></td>

<td><font face="Times" size="+1">queueID;</font></td></tr>

<tr valign=top>

<td width=55></td>

<td nowrap><font face="Times" size="+1">uint16</font></td>

<td><font face="Times" size="+1">jobNumber;</font></td></tr>

<tr valign=top>

<td width=55></td>

<td nowrap><font face="Times" size="+1">NWFileHandle_ta</font></td>

<td><font face="Times" size="+1">fileHandle;</font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=55></td>

<td><font face="Times" size="+1">ccode=<b>NWAbortServicingQueueJob</b>( serverConnID, queueID, jobNumber, fileHandle );</font></td></tr>

</table>

<p><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=5></td>

<td><font face="Helvetica" size="+1"><b>Input</b></font></td></tr>

</table>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=55></td>

<td><font face="Times" size="+1"><i>serverConnID</i> passes the job server connection ID.</font>

<p><font face="Times" size="+1"><i>queueID</i> passes the bindery object ID for the queue in which the aborted job is located.</font>

<p><font face="Times" size="+1"><i>jobNumber</i> passes the job number of the aborted job.</font>

<p><font face="Times" size="+1"><i>fileHandle</i> passes a pointer to the file handle of the file associated with the aborted job.</font></td></tr>

</table>

<p><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=5></td>

<td><font face="Helvetica" size="+1"><b>Output</b></font></td></tr>

</table>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=55></td>

<td><img src="../Images/sp.gif" width=3 height=1><font face="Times" size="+1">None.</font></td></tr>

</table>

<p><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=5></td>

<td><font face="Helvetica" size="+1"><b>Return Value</b></font></td></tr>

</table>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=58></td>

<td nowrap><font face="Times" size="+1">0</font></td>

<td><font face="Times" size="+1">Successful.</font></td></tr>

</table>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=55></td>

<td nowrap><font face="Times" size="+1">-1</font></td>

<td><font face="Times" size="+1">Unsuccessful.&nbsp; One of the following error codes is placed in NWErrno</font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times" size="+1">0x99 (153)</font></td>

<td><font face="Times" size="+1">Directory Full</font></td></tr>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times" size="+1">0xD0 (208)</font></td>

<td><font face="Times" size="+1">Queue Error</font></td></tr>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times" size="+1">0xD1 (209)</font></td>

<td><font face="Times" size="+1">No Queue</font></td></tr>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times" size="+1">0xD2 (210)</font></td>

<td><font face="Times" size="+1">No Queue Server</font></td></tr>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times" size="+1">0xD3 (211)</font></td>

<td><font face="Times" size="+1">No Queue Rights</font></td></tr>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times" size="+1">0xD4 (212)</font></td>

<td><font face="Times" size="+1">Queue Full</font></td></tr>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times" size="+1">0xD5 (213)</font></td>

<td><font face="Times" size="+1">No Queue Job</font></td></tr>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times" size="+1">0xD6 (214)</font></td>

<td><font face="Times" size="+1">No Job Right</font></td></tr>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times" size="+1">0xD7 (215)</font></td>

<td><font face="Times" size="+1">Queue Servicing</font></td></tr>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times" size="+1">0xD8 (216)</font></td>

<td><font face="Times" size="+1">Queue Not Active</font></td></tr>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times" size="+1">0xD9 (217)</font></td>

<td><font face="Times" size="+1">Station Not Server</font></td></tr>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times" size="+1">0xDA (218)</font></td>

<td><font face="Times" size="+1">Queue Halted</font></td></tr>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times" size="+1">0xDB (219)</font></td>

<td><font face="Times" size="+1">Max. Queue Servers</font></td></tr>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times" size="+1">0xFF (255)</font></td>

<td><font face="Times" size="+1">Failure</font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=54></td>

<td nowrap><font face="Times" size="+1"><b>Note:</b></font></td>

<td><font face="Times" size="+1">Because NWCloseFile function is called with NWAbortServicingQueueJob, you may receive an NWErrno = 0x001100xx. The 0x0011 indicates a file system services error. See Appendix B for a complete listing of possible NetWare errors.</font></td></tr>

</table>

<p><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=5></td>

<td><font face="Helvetica" size="+1"><b>Description</b></font></td></tr>

</table>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=55></td>

<td><font face="Times" size="+1">This function call allows a job server to inform the queue manager that it cannot complete servicing a job previously accepted for service.&nbsp; This function closes the job file and resets the job server's access rights to their original (login) values.</font>

<p><font face="Times" size="+1">An aborted job returns to its former position in the job queue if its Service Restart flag (bit 0x10 of the jobControlFlags field in the NWQueueJobStruct_t) is set.&nbsp; For example, if a job is at the beginning of the queue before being called, it returns to the beginning of the queue after being aborted.&nbsp; An aborted job could, therefore, be next in line for service.&nbsp; For this reason, a job should not be aborted because of an error in the job's format or requests.&nbsp; Instead, use the</font><br>
<font face="Times" size="+1">NWFinishServicingQueueJob function.</font></td></tr>

</table>

<p><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=5></td>

<td><font face="Helvetica" size="+1"><b>Notes</b></font></td></tr>

</table>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=55></td>

<td><font face="Times" size="+1">A job should be aborted only if some temporary internal problem prevents it from completing.&nbsp; For example, a print job might be aborted if the printer has a paper jam.&nbsp; After the paper jam is corrected, the job server can service the job successfully.</font>

<p><font face="Times" size="+1">IMPORTANT:&nbsp; If a job is attempting to access data without proper security clearance and is aborted, the job will remain in the queue and be serviced and aborted again and again.&nbsp; To remove a job from the job queue, a user would have to use the&nbsp; NWCloseFileAndAbortQueueJob call, or the queue server would have to use the NWFinishServicingQueueJob call.</font>

<p><font face="Times" size="+1">Only a queue server that has previously accepted a job for service can make this function call.</font></td></tr>

</table>

<p><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=5></td>

<td><font face="Helvetica" size="+1"><b>See Also</b></font></td></tr>

</table>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=55></td>

<td><font face="Times" size="+1">NWChangeQueueJobEntry</font><br>
<font face="Times" size="+1">NWCreateQueueFile</font><br>
<font face="Times" size="+1">NWFinishServicingQueueJob</font><br>
<font face="Times" size="+1">NWReadQueueJobEntry</font></td></tr>

</table>

<p><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=5></td>

<td><font face="Helvetica" size="+1"><b>NWAttachQueueServerToQueue</b></font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=55></td>

<td><font face="Times" size="+1">This function attaches the calling client to the specified queue as a queue server.</font></td></tr>

</table>

<p><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=5></td>

<td><font face="Helvetica" size="+1"><b>Synopsis</b></font></td></tr>

</table>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=55></td>

<td><font face="Times" size="+1">#include &#34;netware/nwapi.h&#34;</font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=55></td>

<td nowrap><font face="Times" size="+1">int</font></td>

<td><font face="Times" size="+1">ccode;</font></td></tr>

<tr valign=top>

<td width=55></td>

<td nowrap><font face="Times" size="+1">uint16</font></td>

<td><font face="Times" size="+1">serverConnID;</font></td></tr>

<tr valign=top>

<td width=55></td>

<td nowrap><font face="Times" size="+1">uint32</font></td>

<td><font face="Times" size="+1">queueID;</font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=55></td>

<td><font face="Times" size="+1">ccode=<b>NWAttachQueueServerToQueue</b>( serverConnID, queueID );</font></td></tr>

</table>

<p><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=5></td>

<td><font face="Helvetica" size="+1"><b>Input</b></font></td></tr>

</table>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=55></td>

<td><font face="Times" size="+1"><i>serverConnID</i> passes the file server connection ID.</font>

<p><font face="Times" size="+1"><i>queueID</i> passes the bindery object ID of the queue being attached.</font></td></tr>

</table>

<p><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=5></td>

<td><font face="Helvetica" size="+1"><b>Output</b></font></td></tr>

</table>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=55></td>

<td><font face="Times" size="+1">None.</font></td></tr>

</table>

<p><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=5></td>

<td><font face="Helvetica" size="+1"><b>Return Value</b></font></td></tr>

</table>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=58></td>

<td nowrap><font face="Times" size="+1">0</font></td>

<td><font face="Times" size="+1">Successful.</font></td></tr>

</table>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=55></td>

<td nowrap><font face="Times" size="+1">-1</font></td>

<td><font face="Times" size="+1">Unsuccessful.&nbsp; One of the following error codes is placed in NWErrno.</font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times" size="+1">0x99 (153)</font></td>

<td><font face="Times" size="+1">Directory Full</font></td></tr>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times" size="+1">0xD0 (208)</font></td>

<td><font face="Times" size="+1">Queue Error</font></td></tr>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times" size="+1">0xD1 (209)</font></td>

<td><font face="Times" size="+1">No Queue</font></td></tr>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times" size="+1">0xD2 (210)</font></td>

<td><font face="Times" size="+1">No Queue Server</font></td></tr>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times" size="+1">0xD3 (211)</font></td>

<td><font face="Times" size="+1">No Queue Rights</font></td></tr>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times" size="+1">0xD4 (212)</font></td>

<td><font face="Times" size="+1">Queue Full</font></td></tr>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times" size="+1">0xD5 (213)</font></td>

<td><font face="Times" size="+1">No Queue Job</font></td></tr>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times" size="+1">0xD6 (214)</font></td>

<td><font face="Times" size="+1">No Job Right</font></td></tr>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times" size="+1">0xD7 (215)</font></td>

<td><font face="Times" size="+1">Queue Servicing</font></td></tr>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times" size="+1">0xD8 (216)</font></td>

<td><font face="Times" size="+1">Queue Not Active</font></td></tr>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times" size="+1">0xD9 (217)</font></td>

<td><font face="Times" size="+1">Station Not Server</font></td></tr>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times" size="+1">0xDA (218)</font></td>

<td><font face="Times" size="+1">Queue Halted</font></td></tr>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times" size="+1">0xDB (219)</font></td>

<td><font face="Times" size="+1">Max. Queue Servers</font></td></tr>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times" size="+1">0xFF (255)</font></td>

<td><font face="Times" size="+1">Failure</font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=55></td>

<td><font face="Times" size="+1">See Appendix B for a complete listing of possible NetWare errors and a description of the four bytes in NWErrno.</font></td></tr>

</table>

<p><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=5></td>

<td><font face="Helvetica" size="+1"><b>Description</b></font></td></tr>

</table>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=55></td>

<td><font face="Times" size="+1">This function call is created for queue job servers and must be used before the job server can perform any services in the queue.&nbsp; After the queue server has logged in to the file server as a queue server (bindery object), this call establishes a connection between the queue server and the queue. If the queue server logs out of the file server, this connection to the queue will be detached.</font></td></tr>

</table>

<p><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=5></td>

<td><font face="Helvetica" size="+1"><b>Notes</b></font></td></tr>

</table>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=55></td>

<td><font face="Times" size="+1">A client must attach itself to a queue as a job server before it can service jobs from that queue.&nbsp; A queue can have as many as 25 job servers attached. The workstation making this function call must be security equivalent to one of the objects listed in the queue's Q_SERVERS group property.</font></td></tr>

</table>

<p><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=5></td>

<td><font face="Helvetica" size="+1"><b>NWChangeQueueJobEntry</b></font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=55></td>

<td><font face="Times" size="+1">This function changes the information about a job in a queue.</font></td></tr>

</table>

<p><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=5></td>

<td><font face="Helvetica" size="+1"><b>Synopsis</b></font></td></tr>

</table>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=55></td>

<td><font face="Times" size="+1">#include &#34;netware/nwapi.h&#34;;</font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=55></td>

<td nowrap><font face="Times" size="+1">int</font></td>

<td><font face="Times" size="+1">ccode;</font></td></tr>

<tr valign=top>

<td width=55></td>

<td nowrap><font face="Times" size="+1">uint16</font></td>

<td><font face="Times" size="+1">serverConnID;</font></td></tr>

<tr valign=top>

<td width=55></td>

<td nowrap><font face="Times" size="+1">uint32</font></td>

<td><font face="Times" size="+1">queueID;</font></td></tr>

<tr valign=top>

<td width=55></td>

<td nowrap><font face="Times" size="+1">NWQueueJobStruct_t</font></td>

<td><font face="Times" size="+1">jobStruct;</font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=55></td>

<td><font face="Times" size="+1">ccode=<b>NWChangeQueueJobEntry</b>( serverConnID, queueID, &amp;jobStruct );</font></td></tr>

</table>

<p><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=5></td>

<td><font face="Helvetica" size="+1"><b>Input</b></font></td></tr>

</table>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=55></td>

<td><font face="Times" size="+1"><i>serverConnID</i> passes the file server connection ID.</font>

<p><font face="Times" size="+1"><i>queueID</i> passes the bindery object ID of the queue.</font>

<p><font face="Times" size="+1"><i>jobStruct</i> passes a pointer to the job structure that contains the new information about the job.&nbsp; (See Appendix A, &quot;NWQueueJobStruct_t Structure.&quot;)</font></td></tr>

</table>

<p><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=5></td>

<td><font face="Helvetica" size="+1"><b>Output</b></font></td></tr>

</table>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=55></td>

<td><font face="Times" size="+1">None.</font></td></tr>

</table>

<p><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=5></td>

<td><font face="Helvetica" size="+1"><b>Return Value</b></font></td></tr>

</table>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=58></td>

<td nowrap><font face="Times" size="+1">0</font></td>

<td><font face="Times" size="+1">Successful.</font></td></tr>

</table>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=55></td>

<td nowrap><font face="Times" size="+1">-1</font></td>

<td><font face="Times" size="+1">Unsuccessful.&nbsp; One of the following error codes is placed in NWErrno.</font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times" size="+1">0x99 (153)</font></td>

<td><font face="Times" size="+1">Directory Full</font></td></tr>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times" size="+1">0xD0 (208)</font></td>

<td><font face="Times" size="+1">Queue Error</font></td></tr>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times" size="+1">0xD1 (209)</font></td>

<td><font face="Times" size="+1">No Queue</font></td></tr>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times" size="+1">0xD2 (210)</font></td>

<td><font face="Times" size="+1">No Queue Server</font></td></tr>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times" size="+1">0xD3 (211)</font></td>

<td><font face="Times" size="+1">No Queue Rights</font></td></tr>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times" size="+1">0xD4 (212)</font></td>

<td><font face="Times" size="+1">Queue Full</font></td></tr>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times" size="+1">0xD5 (213)</font></td>

<td><font face="Times" size="+1">No Queue Job</font></td></tr>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times" size="+1">0xD6 (214)</font></td>

<td><font face="Times" size="+1">No Job Right</font></td></tr>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times" size="+1">0xD7 (215)</font></td>

<td><font face="Times" size="+1">Queue Servicing</font></td></tr>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times" size="+1">0xD8 (216)</font></td>

<td><font face="Times" size="+1">Queue Not Active</font></td></tr>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times" size="+1">0xD9 (217)</font></td>

<td><font face="Times" size="+1">Station Not Server</font></td></tr>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times" size="+1">0xDA (218)</font></td>

<td><font face="Times" size="+1">Queue Halted</font></td></tr>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times" size="+1">0xDB (219)</font></td>

<td><font face="Times" size="+1">Max. Queue Servers</font></td></tr>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times" size="+1">0xFF (255)</font></td>

<td><font face="Times" size="+1">Failure</font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=55></td>

<td><font face="Times" size="+1">See Appendix B for a complete listing of possible NetWare errors and a description of the four bytes in NWErrno.</font></td></tr>

</table>

<p><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=5></td>

<td><font face="Helvetica" size="+1"><b>Description</b></font></td></tr>

</table>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=55></td>

<td><font face="Times" size="+1">The following fields in the NWQueueJobStruct_t structure may be changed by the owner of the job or by a queue operator:</font>

<p><img src="../Images/sp.gif" width=50 height=1><font face="Times" size="+1">targetServerID</font><br>
<img src="../Images/sp.gif" width=50 height=1><font face="Times" size="+1">targetExecutionTime</font><br>
<img src="../Images/sp.gif" width=50 height=1><font face="Times" size="+1">jobType</font><br>
<img src="../Images/sp.gif" width=50 height=1><font face="Times" size="+1">jobControlFlags</font><br>
<img src="../Images/sp.gif" width=50 height=1><font face="Times" size="+1">jobDescription</font><br>
<img src="../Images/sp.gif" width=50 height=1><font face="Times" size="+1">queueRecord</font>

<p><font face="Times" size="+1">If the caller is an operator, the Operator Hold flag can be reset to a value supplied by the caller.</font>

<p><font face="Times" size="+1">Use NWChangeQueueJobPosition to change the job's service position in the queue.</font></td></tr>

</table>

<p><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=5></td>

<td><font face="Helvetica" size="+1"><b>Notes</b></font></td></tr>

</table>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=55></td>

<td><font face="Times" size="+1">The NWChangeQueueJobEntry function can be used in conjunction with the NWReadQueueJobEntry function to change a portion of the job's entry record.&nbsp; However, if the target entry is already being serviced, the</font><br>
<font face="Times" size="+1">NWChangeQueueJobEntry function returns a servicing error and makes no changes to the job's entry record.</font>

<p><font face="Times" size="+1">If this call is being used in conjunction with printing and the NWPrintStruct_t, the structure must first be converted (using the</font><br>
<font face="Times" size="+1">NWConvertPrintStructToQueueStruct) before this call is made.</font></td></tr>

</table>

<p><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=5></td>

<td><font face="Helvetica" size="+1"><b>See Also</b></font></td></tr>

</table>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=55></td>

<td><font face="Times" size="+1">NWChangeQueueJobEntry</font><br>
<font face="Times" size="+1">NWChangeQueueJobPosition</font><br>
<font face="Times" size="+1">NWConvertPrintStructToQueueStruct</font><br>
<font face="Times" size="+1">NWGetQueueJobList</font><br>
<font face="Times" size="+1">NWReadQueueJobEntry</font><br>
<font face="Times" size="+1">NWRemoveJobFromQueue</font></td></tr>

</table>

<p><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=5></td>

<td><font face="Helvetica" size="+1"><b>NWChangeQueueJobPosition</b></font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=55></td>

<td><font face="Times" size="+1">This function changes a job's position in a queue.</font></td></tr>

</table>

<p><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=5></td>

<td><font face="Helvetica" size="+1"><b>Synopsis</b></font></td></tr>

</table>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=55></td>

<td><font face="Times" size="+1">#include &#34;netware/nwapi.h&#34;</font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=55></td>

<td nowrap><font face="Times" size="+1">int</font></td>

<td><font face="Times" size="+1">ccode;</font></td></tr>

<tr valign=top>

<td width=55></td>

<td nowrap><font face="Times" size="+1">uint16</font></td>

<td><font face="Times" size="+1">serverConnID;</font></td></tr>

<tr valign=top>

<td width=55></td>

<td nowrap><font face="Times" size="+1">uint32</font></td>

<td><font face="Times" size="+1">queueID;</font></td></tr>

<tr valign=top>

<td width=55></td>

<td nowrap><font face="Times" size="+1">uint16</font></td>

<td><font face="Times" size="+1">jobNumber;</font></td></tr>

<tr valign=top>

<td width=55></td>

<td nowrap><font face="Times" size="+1">uint8</font></td>

<td><font face="Times" size="+1">newJobPosition;</font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=55></td>

<td><font face="Times" size="+1">ccode=<b>NWChangeQueueJobPosition</b>( serverConnID, queueID, jobNumber,&nbsp; newJobPosition );</font></td></tr>

</table>

<p><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=5></td>

<td><font face="Helvetica" size="+1"><b>Input</b></font></td></tr>

</table>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=55></td>

<td><font face="Times" size="+1"><i>serverConnID</i> passes the file server connection ID.</font>

<p><font face="Times" size="+1"><i>queueID</i> passes the bindery object ID of the affected queue.</font>

<p><font face="Times" size="+1"><i>jobNumber</i> passes the job number of the job being repositioned.</font>

<p><font face="Times" size="+1"><i>newJobPosition</i> passes the job's new position.</font></td></tr>

</table>

<p><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=5></td>

<td><font face="Helvetica" size="+1"><b>Output</b></font></td></tr>

</table>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=55></td>

<td><font face="Times" size="+1">None.</font></td></tr>

</table>

<p><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=5></td>

<td><font face="Helvetica" size="+1"><b>Return Value</b></font></td></tr>

</table>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=58></td>

<td nowrap><font face="Times" size="+1">0</font></td>

<td><font face="Times" size="+1">Successful.</font></td></tr>

</table>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=55></td>

<td nowrap><font face="Times" size="+1">-1</font></td>

<td><font face="Times" size="+1">Unsuccessful.&nbsp; One of the following error codes is placed in NWErrno.</font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times" size="+1">0x99 (153)</font></td>

<td><font face="Times" size="+1">Directory Full</font></td></tr>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times" size="+1">0xD0 (208)</font></td>

<td><font face="Times" size="+1">Queue Error</font></td></tr>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times" size="+1">0xD1 (209)</font></td>

<td><font face="Times" size="+1">No Queue</font></td></tr>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times" size="+1">0xD2 (210)</font></td>

<td><font face="Times" size="+1">No Queue Server</font></td></tr>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times" size="+1">0xD3 (211)</font></td>

<td><font face="Times" size="+1">No Queue Rights</font></td></tr>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times" size="+1">0xD4 (212)</font></td>

<td><font face="Times" size="+1">Queue Full</font></td></tr>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times" size="+1">0xD5 (213)</font></td>

<td><font face="Times" size="+1">No Queue Job</font></td></tr>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times" size="+1">0xD6 (214)</font></td>

<td><font face="Times" size="+1">No Job Right</font></td></tr>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times" size="+1">0xD7 (215)</font></td>

<td><font face="Times" size="+1">Queue Servicing</font></td></tr>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times" size="+1">0xD8 (216)</font></td>

<td><font face="Times" size="+1">Queue Not Active</font></td></tr>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times" size="+1">0xD9 (217)</font></td>

<td><font face="Times" size="+1">Station Not Server</font></td></tr>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times" size="+1">0xDA (218)</font></td>

<td><img src="../Images/sp.gif" width=3 height=1><font face="Times" size="+1">Queue Halted</font></td></tr>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times" size="+1">0xDB (219)</font></td>

<td><font face="Times" size="+1">Max. Queue Servers</font></td></tr>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times" size="+1">0xFF (255)</font></td>

<td><font face="Times" size="+1">Failure</font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=55></td>

<td><font face="Times" size="+1">See Appendix B for a complete listing of possible NetWare errors and a description of the four bytes in NWErrno.</font></td></tr>

</table>

<p><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=5></td>

<td><font face="Helvetica" size="+1"><b>Description</b></font></td></tr>

</table>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=55></td>

<td><font face="Times" size="+1">The value of the newJobPosition parameter ranges from 1 to 250.&nbsp; Position 1 is the first position in the queue and position 250 is the last position in a full queue. If a specified position number places the job beyond the current end of the queue, the job is placed at the end of the current queue.</font></td></tr>

</table>

<p><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=5></td>

<td><font face="Helvetica" size="+1"><b>Notes</b></font></td></tr>

</table>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=55></td>

<td><font face="Times" size="+1">When a job is moved in the queue, the positions of all job entries are updated to reflect the change.&nbsp; Changing the position of a job being serviced has no effect on the service of that job.&nbsp; Be aware that job positions change as other jobs in the queue are finished being serviced.</font>

<p><font face="Times" size="+1">The application making this call must be logged in as supervisor.</font></td></tr>

</table>

<p><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=5></td>

<td><font face="Helvetica" size="+1"><b>See Also</b></font></td></tr>

</table>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=55></td>

<td><font face="Times" size="+1">NWChangeQueueJobEntry</font><br>
<font face="Times" size="+1">NWGetQueueJobList</font><br>
<font face="Times" size="+1">NWReadQueueJobEntry</font><br>
<font face="Times" size="+1">NWRemoveJobFromQueue</font></td></tr>

</table>

<p><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=5></td>

<td><font face="Helvetica" size="+1"><b>NWChangeToClientRights</b></font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=55></td>

<td><font face="Times" size="+1">This function changes a queue server's current login identity to match the identity of the client for whom the queue server is acting.</font></td></tr>

</table>

<p><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=5></td>

<td><font face="Helvetica" size="+1"><b>Synopsis</b></font></td></tr>

</table>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=55></td>

<td><font face="Times" size="+1">#include &#34;netware/nwapi.h&#34;</font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=55></td>

<td nowrap><font face="Times" size="+1">int</font></td>

<td><font face="Times" size="+1">ccode;</font></td></tr>

<tr valign=top>

<td width=55></td>

<td nowrap><font face="Times" size="+1">uint16</font></td>

<td><font face="Times" size="+1">serverConnID;</font></td></tr>

<tr valign=top>

<td width=55></td>

<td nowrap><font face="Times" size="+1">uint32</font></td>

<td><font face="Times" size="+1">queueID;</font></td></tr>

<tr valign=top>

<td width=55></td>

<td nowrap><font face="Times" size="+1">uint16</font></td>

<td><font face="Times" size="+1">jobNumber;</font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=55></td>

<td><font face="Times" size="+1">ccode=<b>NWChangeToClientRights</b>( serverConnID, queueID, jobNumber );</font></td></tr>

</table>

<p><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=5></td>

<td><font face="Helvetica" size="+1"><b>Input</b></font></td></tr>

</table>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=55></td>

<td><font face="Times" size="+1"><i>serverConnID</i> passes the queue server connection ID.</font>

<p><font face="Times" size="+1"><i>queueID</i> passes the bindery object ID of the queue.</font>

<p><font face="Times" size="+1"><i>jobNumber</i> passes the job's job number.</font></td></tr>

</table>

<p><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=5></td>

<td><font face="Helvetica" size="+1"><b>Output</b></font></td></tr>

</table>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=55></td>

<td><font face="Times" size="+1">None.</font></td></tr>

</table>

<p><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=5></td>

<td><font face="Helvetica" size="+1"><b>Return Value</b></font></td></tr>

</table>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=58></td>

<td nowrap><font face="Times" size="+1">0</font></td>

<td><font face="Times" size="+1">Successful.</font></td></tr>

</table>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=55></td>

<td nowrap><font face="Times" size="+1">-1</font></td>

<td><font face="Times" size="+1">Unsuccessful.&nbsp; One of the following error codes is placed in NWErrno.</font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times" size="+1">0x99 (153)</font></td>

<td><font face="Times" size="+1">Directory Full</font></td></tr>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times" size="+1">0xD0 (208)</font></td>

<td><font face="Times" size="+1">Queue Error</font></td></tr>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times" size="+1">0xD1 (209)</font></td>

<td><font face="Times" size="+1">No Queue</font></td></tr>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times" size="+1">0xD2 (210)</font></td>

<td><font face="Times" size="+1">No Queue Server</font></td></tr>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times" size="+1">0xD3 (211)</font></td>

<td><font face="Times" size="+1">No Queue Rights</font></td></tr>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times" size="+1">0xD4 (212)</font></td>

<td><font face="Times" size="+1">Queue Full</font></td></tr>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times" size="+1">0xD5 (213)</font></td>

<td><font face="Times" size="+1">No Queue Job</font></td></tr>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times" size="+1">0xD6 (214)</font></td>

<td><font face="Times" size="+1">No Job Right</font></td></tr>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times" size="+1">0xD7 (215)</font></td>

<td><font face="Times" size="+1">Queue Servicing</font></td></tr>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times" size="+1">0xD8 (216)</font></td>

<td><font face="Times" size="+1">Queue Not Active</font></td></tr>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times" size="+1">0xD9 (217)</font></td>

<td><font face="Times" size="+1">Station Not Server</font></td></tr>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times" size="+1">0xDA (218)</font></td>

<td><font face="Times" size="+1">Queue Halted</font></td></tr>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times" size="+1">0xDB (219)</font></td>

<td><font face="Times" size="+1">Max. Queue Servers</font></td></tr>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times" size="+1">0xFF (255)</font></td>

<td><font face="Times" size="+1">Failure</font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=55></td>

<td><font face="Times" size="+1">See Appendix B for a complete listing of possible NetWare errors and a description of the four bytes in NWErrno.</font></td></tr>

</table>

<p><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=5></td>

<td><font face="Helvetica" size="+1"><b>Description</b></font></td></tr>

</table>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=55></td>

<td><font face="Times" size="+1">This function allows a queue server to change its current login identity to match the identity of the client for which it is acting.&nbsp; This is useful if the queue server must access files owned by the client but not submitted to the queue by the client (in other words, if the server must go out and retrieve files by itself).&nbsp; The queue server's login user ID and associated security equivalence list are replaced by the ID and security equivalence list of the user who placed the job in the queue.</font>

<p><font face="Times" size="+1">This function does not change any path mappings that the queue server may have on the job server.&nbsp; However, all access rights to those directories are recalculated to conform to the rights of the queue client.&nbsp; Files opened before this call is made will continue to be accessible with the server's rights.&nbsp; Files opened after this call is made will be accessible only with the client's rights.</font></td></tr>

</table>

<p><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=5></td>

<td><font face="Helvetica" size="+1"><b>Notes</b></font></td></tr>

</table>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=55></td>

<td><font face="Times" size="+1">The job server is responsible for creating any path mappings that it may need to carry out the client's requests after this call has been made.</font>

<p><font face="Times" size="+1">The NWRestoreQueueServerRights function reverses the effects of the NWChangeToClientRights function. In addition, the server's rights are automatically reset if the server issues a NWFinishServicingQueueJob or</font><br>
<font face="Times" size="+1">NWAbortServicingQueueJob function.</font>

<p><font face="Times" size="+1">Only a queue server that has previously accepted a job for service can call this function.</font></td></tr>

</table>

<p><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=5></td>

<td><font face="Helvetica" size="+1"><b>See Also</b></font></td></tr>

</table>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=55></td>

<td><font face="Times" size="+1">NWAbortServicingQueueJob</font><br>
<font face="Times" size="+1">NWFinishServicingQueueJob</font><br>
<font face="Times" size="+1">NWRestoreQueueServerRights</font></td></tr>

</table>

<p><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=5></td>

<td><font face="Helvetica" size="+1"><b>NWCloseFileAndAbortQueueJob</b></font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=55></td>

<td><font face="Times" size="+1">This function signals the QMS that a job has not been created properly and should be removed from the queue.</font></td></tr>

</table>

<p><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=5></td>

<td><font face="Helvetica" size="+1"><b>Synopsis</b></font></td></tr>

</table>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=55></td>

<td><font face="Times" size="+1">#include &#34;netware/nwapi.h&#34;</font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=55></td>

<td nowrap><font face="Times" size="+1">int</font></td>

<td><font face="Times" size="+1">ccode;</font></td></tr>

<tr valign=top>

<td width=55></td>

<td nowrap><font face="Times" size="+1">uint16</font></td>

<td><font face="Times" size="+1">serverConnID;</font></td></tr>

<tr valign=top>

<td width=55></td>

<td nowrap><font face="Times" size="+1">uint32</font></td>

<td><font face="Times" size="+1">queueID;</font></td></tr>

<tr valign=top>

<td width=55></td>

<td nowrap><font face="Times" size="+1">uint16</font></td>

<td><font face="Times" size="+1">jobNumber;</font></td></tr>

<tr valign=top>

<td width=55></td>

<td nowrap><font face="Times" size="+1">NWFileHandle_ta</font></td>

<td><font face="Times" size="+1">fileHandle;</font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=55></td>

<td><font face="Times" size="+1">ccode=<b>NWCloseFileAndAbortQueueJob</b>( serverConnID, queueID,</font><br>
<font face="Times" size="+1">jobNumber,&nbsp; fileHandle );</font></td></tr>

</table>

<p><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=5></td>

<td><font face="Helvetica" size="+1"><b>Input</b></font></td></tr>

</table>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=55></td>

<td><font face="Times" size="+1"><i>serverConnID</i> passes the queue server connection ID.</font>

<p><font face="Times" size="+1"><i>queueID</i> passes the bindery object ID of the affected queue.</font>

<p><font face="Times" size="+1"><i>jobNumber</i> passes the job entry number of the job whose service is being&nbsp; aborted.</font>

<p><font face="Times" size="+1"><i>fileHandle</i> passes a pointer to the file handle of the aborted job's file (returned from the NWCreateQueueFile function call).</font></td></tr>

</table>

<p><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=5></td>

<td><font face="Helvetica" size="+1"><b>Output</b></font></td></tr>

</table>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=55></td>

<td><font face="Times" size="+1">None.</font></td></tr>

</table>

<p><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=5></td>

<td><font face="Helvetica" size="+1"><b>Return Values</b></font></td></tr>

</table>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=58></td>

<td nowrap><font face="Times" size="+1">0</font></td>

<td><font face="Times" size="+1">Successful.</font></td></tr>

</table>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=55></td>

<td nowrap><font face="Times" size="+1">-1</font></td>

<td><font face="Times" size="+1">Unsuccessful.&nbsp; One of the following error codes is placed in NWErrno.</font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times" size="+1">0xD1</font></td>

<td><font face="Times" size="+1">No Queue</font></td></tr>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times" size="+1">0xD3</font></td>

<td><font face="Times" size="+1">No Queue Rights</font></td></tr>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times" size="+1">0xD4</font></td>

<td><font face="Times" size="+1">Queue Full</font></td></tr>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times" size="+1">0xD5</font></td>

<td><font face="Times" size="+1">No Queue Job</font></td></tr>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times" size="+1">0xF5</font></td>

<td><font face="Times" size="+1">No Such Object</font></td></tr>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times" size="+1">0xD6</font></td>

<td><font face="Times" size="+1">No Job Right</font></td></tr>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times" size="+1">0xD7</font></td>

<td><font face="Times" size="+1">Queue Servicing</font></td></tr>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times" size="+1">0xD8</font></td>

<td><font face="Times" size="+1">Queue Not Active</font></td></tr>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times" size="+1">0xFF</font></td>

<td><font face="Times" size="+1">Invalid File Handle</font></td></tr>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times" size="+1">0x30</font></td>

<td><font face="Times" size="+1">Invalid Connection ID</font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=54></td>

<td nowrap><font face="Times" size="+1"><b>Note:</b></font></td>

<td><font face="Times" size="+1">Because this API uses NWCloseFile, it is possible to get an NWErrno = 0x001100xx.&nbsp; The 0x0011 signifies a file system error.&nbsp; See Appendix B for a complete listing of possible NetWare errors and a description of the four bytes in NWErrno.</font></td></tr>

</table>

<p><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=5></td>

<td><font face="Helvetica" size="+1"><b>Description</b></font></td></tr>

</table>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=55></td>

<td><font face="Times" size="+1">This function allows the client to close a queue job and abort it.&nbsp; The jobNumber parameter contains the job number returned by QMS when the job was originally entered in the queue.&nbsp; The file associated with that job number is closed, and the job is deleted from the queue.</font></td></tr>

</table>

<p><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=9></td>

<td><font face="Helvetica" size="+1"><b>Notes</b></font></td></tr>

</table>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=55></td>

<td><font face="Times" size="+1">Only the client that created the queue job can call this function.</font></td></tr>

</table>

<p><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=5></td>

<td><font face="Helvetica" size="+1"><b>See Also</b></font></td></tr>

</table>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=55></td>

<td><font face="Times" size="+1">NWCloseFileAndStartQueueJob</font><br>
<font face="Times" size="+1">NWCreateQueueFile</font><br>
<font face="Times" size="+1">NWRemoveJobFromQueue</font></td></tr>

</table>

<p><br><br><br><br><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=5></td>

<td><font face="Helvetica" size="+1"><b>NWCloseFileAndStartQueueJob</b></font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=55></td>

<td><font face="Times" size="+1">This function closes a queue file and marks it ready for execution.</font></td></tr>

</table>

<p><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=5></td>

<td><font face="Helvetica" size="+1"><b>Synopsis</b></font></td></tr>

</table>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=55></td>

<td><font face="Times" size="+1">#include &#34;netware/nwapi.h&#34;</font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=55></td>

<td nowrap><font face="Times" size="+1">int</font></td>

<td><font face="Times" size="+1">ccode;</font></td></tr>

<tr valign=top>

<td width=55></td>

<td nowrap><font face="Times" size="+1">uint16</font></td>

<td><font face="Times" size="+1">serverConnID;</font></td></tr>

<tr valign=top>

<td width=55></td>

<td nowrap><font face="Times" size="+1">uint32</font></td>

<td><font face="Times" size="+1">queueID;</font></td></tr>

<tr valign=top>

<td width=55></td>

<td nowrap><font face="Times" size="+1">uint16</font></td>

<td><font face="Times" size="+1">jobNumber;</font></td></tr>

<tr valign=top>

<td width=55></td>

<td nowrap><font face="Times" size="+1">NWFileHandle_ta</font></td>

<td><font face="Times" size="+1">fileHandle;</font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=55></td>

<td><font face="Times" size="+1">ccode=<b>NWCloseFileAndStartQueueJob</b>( serverConnID, queueID,</font><br>
<font face="Times" size="+1">jobNumber,&nbsp; fileHandle );</font></td></tr>

</table>

<p><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=5></td>

<td><font face="Helvetica" size="+1"><b>Input</b></font></td></tr>

</table>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=55></td>

<td><font face="Times" size="+1"><i>serverConnID</i> passes the queue server connection ID.</font>

<p><font face="Times" size="+1"><i>queueID</i> passes the bindery object ID of the queue in which the specified job was placed.</font>

<p><font face="Times" size="+1"><i>jobNumber</i> passes the job number of the job to be serviced.</font>

<p><font face="Times" size="+1"><i>fileHandle</i> passes a pointer to the file handle of the file associated with the job to be executed (returned from the NWCreateQueueFile function call).</font></td></tr>

</table>

<p><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=5></td>

<td><font face="Helvetica" size="+1"><b>Output</b></font></td></tr>

</table>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=55></td>

<td><font face="Times" size="+1">None.</font></td></tr>

</table>

<p><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=5></td>

<td><font face="Helvetica" size="+1"><b>Return Values</b></font></td></tr>

</table>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=58></td>

<td nowrap><font face="Times" size="+1">0</font></td>

<td><font face="Times" size="+1">Successful.</font></td></tr>

</table>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=55></td>

<td nowrap><font face="Times" size="+1">-1</font></td>

<td><font face="Times" size="+1">Unsuccessful.&nbsp; One of the following error codes is placed in NWErrno.</font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times" size="+1">0xD1</font></td>

<td><font face="Times" size="+1">No Queue</font></td></tr>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times" size="+1">0xD3</font></td>

<td><font face="Times" size="+1">No Queue Rights</font></td></tr>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times" size="+1">0xD5</font></td>

<td><font face="Times" size="+1">No Queue Job</font></td></tr>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times" size="+1">0xF5</font></td>

<td><font face="Times" size="+1">No Such Object</font></td></tr>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times" size="+1">0xD7</font></td>

<td><font face="Times" size="+1">Queue Servicing</font></td></tr>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times" size="+1">0xD8</font></td>

<td><font face="Times" size="+1">Queue Not Active</font></td></tr>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times" size="+1">0xFF</font></td>

<td><font face="Times" size="+1">Invalid File Handle</font></td></tr>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times" size="+1">0x30</font></td>

<td><font face="Times" size="+1">Invalid Connection ID</font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=54></td>

<td nowrap><font face="Times" size="+1"><b>Note:</b></font></td>

<td><font face="Times" size="+1">Because this API uses NWCloseFile, it is possible to get an</font><br>
<font face="Times" size="+1">NWErrno = 0x001100xx.&nbsp; The 0x0011 signifies a file system error.&nbsp; See Appendix B for a complete listing of possible NetWare errors and a description of the four bytes in NWErrno.</font></td></tr>

</table>

<p><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=5></td>

<td><font face="Helvetica" size="+1"><b>Description</b></font></td></tr>

</table>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=55></td>

<td><font face="Times" size="+1">This function allows the workstation to close a queue job file and mark the job for execution.</font>

<p><font face="Times" size="+1">The jobNumber parameter contains the job number returned by QMS when the job was originally entered in the queue.</font>

<p><font face="Times" size="+1">When this function finishes, the specified job is ready for execution, if the userHoldFlag and operatorHoldFlag fields are both cleared and the</font><br>
<font face="Times" size="+1">targetExecutionTime was either not specified or has elapsed (set with the</font><br>
<font face="Times" size="+1">jobStruct parameter when the file was created).</font></td></tr>

</table>

<p><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=5></td>

<td><font face="Helvetica" size="+1"><b>Notes</b></font></td></tr>

</table>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=55></td>

<td><font face="Times" size="+1">Only the client that created the job can call this function.</font></td></tr>

</table>

<p><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=5></td>

<td><font face="Helvetica" size="+1"><b>See Also</b></font></td></tr>

</table>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=55></td>

<td><font face="Times" size="+1">NWCloseFileAndAbortQueueJob</font><br>
<font face="Times" size="+1">NWCreateQueueFile</font><br>
<font face="Times" size="+1">NWRemoveJobFromQueue</font></td></tr>

</table>

<p><br><br><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=5></td>

<td><font face="Helvetica" size="+1"><b>NWConvertPrintStructToQueueStruct</b></font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=55></td>

<td><font face="Times" size="+1">This function converts the printRecord to a form acceptable to NetWare print servers.</font></td></tr>

</table>

<p><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=5></td>

<td><font face="Helvetica" size="+1"><b>Synopsis</b></font></td></tr>

</table>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=55></td>

<td><font face="Times" size="+1">#include &quot;nwapi.h&quot;;</font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=55></td>

<td nowrap><font face="Times" size="+1">int</font></td>

<td><font face="Times" size="+1">ccode;</font></td></tr>

<tr valign=top>

<td width=55></td>

<td nowrap><font face="Times" size="+1">NWPrintRecord_t</font></td>

<td><font face="Times" size="+1">printRecord;</font></td></tr>

<tr valign=top>

<td width=55></td>

<td nowrap><font face="Times" size="+1">NWClientRecord_ta</font></td>

<td><font face="Times" size="+1">queueRecord;</font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=55></td>

<td><font face="Times" size="+1">ccode=<b>NWConvertPrintStructToQueueStruct</b>( &amp;printRecord, queueRecord );</font></td></tr>

</table>

<p><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=5></td>

<td><font face="Helvetica" size="+1"><b>Input</b></font></td></tr>

</table>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=55></td>

<td><font face="Times" size="+1"><i>printRecord</i> passes the address of the filled in printRecord structure.&nbsp; (See Appendix A, &quot;NWPrintRecord_t Structure.&quot;)</font>

<p><font face="Times" size="+1"><i>queueRecord</i> passes a pointer to where all of the print information will be stored.&nbsp; (See Appendix A, the queueRecord field in &quot;NWQueueJobStruct_t Structure.&quot;)</font></td></tr>

</table>

<p><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=5></td>

<td><font face="Helvetica" size="+1"><b>Output</b></font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=55></td>

<td><font face="Times" size="+1"><i>queueRecord</i> receives the print record information.&nbsp; (See Appendix A, the queueRecord field in &quot;NWQueueJobStruct_t Structure.&quot;)</font></td></tr>

</table>

<p><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=5></td>

<td><font face="Helvetica" size="+1"><b>Description</b></font></td></tr>

</table>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=55></td>

<td><font face="Times" size="+1">Before this function can be called, all the fields in the NWPrintRecord_t structure must be assigned values. The following sample code assumes that a</font><br>
<font face="Times" size="+1">NWPrintRecord_t structure called prtR1 has been declared.&nbsp; (To automatically set all fields to 0, use menset or declare a static structure.)</font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=55></td>

<td nowrap><font face="Times" size="+1">versionNumber</font></td>

<td><font face="Times" size="+1">Assigns the version number.</font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=55></td>

<td><img src="../Images/sp.gif" width=152 height=1><font face="Times" size="+1"><b>prtR1.versionNumber = 1;</b></font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=55></td>

<td nowrap><font face="Times" size="+1">tabSize</font></td>

<td><font face="Times" size="+1">Assigns the number of spaces tabs will be expanded</font><br>
<font face="Times" size="+1">to (0 -18).&nbsp; The following sample code expands the</font><br>
<font face="Times" size="+1">tab to 8 spaces:</font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=55></td>

<td><img src="../Images/sp.gif" width=152 height=1><font face="Times" size="+1"><b>prtR1.tabSize = 8;</b></font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=55></td>

<td nowrap><font face="Times" size="+1">numCopies</font></td>

<td><font face="Times" size="+1">Assigns the number of copies that will be printed.</font><br>
<font face="Times" size="+1">The following sample code assigns 2 copies:</font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=55></td>

<td><img src="../Images/sp.gif" width=152 height=1><font face="Times" size="+1"><b>prtR1.numCopies = 2;</b></font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=55></td>

<td nowrap><font face="Times" size="+1">controlFlags</font></td>

<td><font face="Times" size="+1">Sets one or more control flags.&nbsp; Use one or more of</font><br>
<font face="Times" size="+1">the following:</font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=55></td>

<td><img src="../Images/sp.gif" width=152 height=1><font face="Times" size="+1">NWPCF_SUPPRESS_FF</font><br>
<img src="../Images/sp.gif" width=152 height=1><font face="Times" size="+1">NWPCF_NOTIFY_USER</font><br>
<img src="../Images/sp.gif" width=152 height=1><font face="Times" size="+1">NWPCF_TEXT_MODE</font><br>
<img src="../Images/sp.gif" width=152 height=1><font face="Times" size="+1">NWPCF_PRINT_BANNER</font>

<p><img src="../Images/sp.gif" width=152 height=1><font face="Times" size="+1">The following sample code suppresses the form feed:</font>

<p><img src="../Images/sp.gif" width=152 height=1><font face="Times" size="+1"><b>prtR1.controlFlags =</b></font><br>
<img src="../Images/sp.gif" width=152 height=1><font face="Times" size="+1">NWPCF_SUPPRESS_FF;</font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=55></td>

<td nowrap><font face="Times" size="+1">linesPerPage</font></td>

<td><font face="Times" size="+1">Assigns the number of lines on one page.&nbsp; The</font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=55></td>

<td><img src="../Images/sp.gif" width=152 height=1><font face="Times" size="+1">following sample code assigns 66 lines per page:</font>

<p><img src="../Images/sp.gif" width=152 height=1><font face="Times" size="+1"><b>prtR1.linesPerPage = 66;</b></font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=55></td>

<td nowrap><font face="Times" size="+1">charsPerLine</font></td>

<td><font face="Times" size="+1">Assigns the number of characters on one line.&nbsp; The</font><br>
<font face="Times" size="+1">following code assigns 132 characters per line:</font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=55></td>

<td><img src="../Images/sp.gif" width=152 height=1><font face="Times" size="+1">prtR1.charsPerLine = 132;</font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=55></td>

<td nowrap><font face="Times" size="+1">formName</font></td>

<td><font face="Times" size="+1">Sets the form to use for printing the job.&nbsp; The</font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=55></td>

<td><img src="../Images/sp.gif" width=152 height=1><font face="Times" size="+1">following sample code sets this field to 0:</font>

<p><img src="../Images/sp.gif" width=152 height=1><font face="Times" size="+1">prtR1.formName[0] = 0;</font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=55></td>

<td nowrap><font face="Times" size="+1">bannerNameField</font></td>

<td><font face="Times" size="+1">Assigns the text that is printed in the first box in the</font><br>
<font face="Times" size="+1">banner.&nbsp; Usually the user's name is printed in this box.</font><br>
<font face="Times" size="+1">The following sample code sets this field to a user</font><br>
<font face="Times" size="+1">named Nikki:</font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=55></td>

<td><img src="../Images/sp.gif" width=152 height=1><font face="Times" size="+1">strcpy(prtR1.bannerNameField, &#34;Nikki&#34;);</font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=55></td>

<td nowrap><font face="Times" size="+1">bannerFileField</font></td>

<td><font face="Times" size="+1">Assigns the text that is printed in the second box in</font><br>
<font face="Times" size="+1">the banner. Usually the file name is printed in this</font><br>
<font face="Times" size="+1">box.&nbsp; The following sample code sets this field to a</font><br>
<font face="Times" size="+1">file name of API.DOC:</font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=55></td>

<td><img src="../Images/sp.gif" width=152 height=1><font face="Times" size="+1">strcpy(prtR1.bannerFileField, &#34;API.DOC&#34;);</font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=55></td>

<td nowrap><font face="Times" size="+1">headerFileName</font></td>

<td><font face="Times" size="+1">Assigns the file name that is printed in the header of</font><br>
<font face="Times" size="+1">the banner.&nbsp; The following sample code sets this field</font><br>
<font face="Times" size="+1">to 0:</font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=55></td>

<td><img src="../Images/sp.gif" width=152 height=1><font face="Times" size="+1">prtR1.headerFileName[0] = 0;</font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=55></td>

<td nowrap><font face="Times" size="+1">directoryPath</font></td>

<td><font face="Times" size="+1">Assigns the full path name of the directory where the</font><br>
<font face="Times" size="+1">file resides.&nbsp; The following sample code assigns the</font><br>
<font face="Times" size="+1">file API.DOC in the SYS:DOC/API directory:</font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=55></td>

<td><img src="../Images/sp.gif" width=152 height=1><font face="Times" size="+1"><b>strcpy(prtR1.directoryPath,</b></font></td></tr>

</table>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=207></td>

<td nowrap><font face="Times" size="+1">&#34;SYS:DOC/API/</font></td>

<td><font face="Times" size="+1">API.DOC&#34;);</font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=55></td>

<td><font face="Times" size="+1">This function performs any necessary byte swapping and word alignment and then copies the printRecord into the queueRecord field in the NWQueueJobStruct_t structure.&nbsp; This call is usually used before calling</font><br>
<font face="Times" size="+1">NWCreateQueueFile.</font>

<p><font face="Times" size="+1">The queueRecord field contains information pertaining to the print job.&nbsp; This information is assigned by the client and is sometimes referred to as the &#34;client record area.&#34;</font></td></tr>

</table>

<p><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=5></td>

<td><font face="Helvetica" size="+1"><b>See Also</b></font></td></tr>

</table>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=55></td>

<td><font face="Times" size="+1">NWCreateQueueFile</font><br>
<font face="Times" size="+1">NWConvertQueueStructToPrintStruct</font></td></tr>

</table>

<p><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=5></td>

<td><font face="Helvetica" size="+1"><b>NWConvertQueueStructToPrintStruct</b></font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=55></td>

<td><font face="Times" size="+1">This function converts the queueRecord (in the NWQueueJobStruct_t) to a</font><br>
<font face="Times" size="+1">printRecord which is in the form originally passed in by the client.</font></td></tr>

</table>

<p><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=5></td>

<td><font face="Helvetica" size="+1"><b>Synopsis</b></font></td></tr>

</table>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=55></td>

<td><font face="Times" size="+1">#include &quot;nwapi.h&quot;;</font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=55></td>

<td nowrap><font face="Times" size="+1">int</font></td>

<td><font face="Times" size="+1">ccode;</font></td></tr>

<tr valign=top>

<td width=55></td>

<td nowrap><font face="Times" size="+1">NWClientRecord_ta</font></td>

<td><font face="Times" size="+1">queueRecord;</font></td></tr>

<tr valign=top>

<td width=55></td>

<td nowrap><font face="Times" size="+1">NWPrintRecord_t</font></td>

<td><font face="Times" size="+1">printRecord;</font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=55></td>

<td><font face="Times" size="+1">ccode=<b>NWConvertQueueStructToPrintStruct</b>( queueRecord,&nbsp; &amp;printRecord );</font></td></tr>

</table>

<p><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=5></td>

<td><font face="Helvetica" size="+1"><b>Input</b></font></td></tr>

</table>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=55></td>

<td><font face="Times" size="+1"><i>queueRecord</i> passes the address of the print information.&nbsp; (See Appendix A, the queueRecord field in &quot;NWQueueJobStruct_t Structure.&quot;)</font>

<p><font face="Times" size="+1"><i>printRecord</i> passes a pointer to the allocated NWPrintRecord_t structure.&nbsp; (See Appendix A, &quot;NWPrintRecord_t Structure.&quot;)</font></td></tr>

</table>

<p><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=5></td>

<td><font face="Helvetica" size="+1"><b>Output</b></font></td></tr>

</table>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=55></td>

<td><font face="Times" size="+1"><i>printRecord</i> fills in the converted queueRecord.&nbsp; (See Appendix A,</font><br>
<font face="Times" size="+1">&quot;NWPrintRecord_t Structure.&quot;)</font></td></tr>

</table>

<p><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=5></td>

<td><font face="Helvetica" size="+1"><b>Description</b></font></td></tr>

</table>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=55></td>

<td><font face="Times" size="+1">This function performs any necessary byte swapping and word alignment and then copies the data back into the printRecord space.&nbsp; This call is necessary for the user to be able to read the fields in the print structure. This function is most often used after NWReadQueueJobEntry.</font>

<p><font face="Times" size="+1">The queueRecord field in the NWQueueJobStruct_t structure is an area which is filled in by the client; it is sometimes referred to as &quot;client record area.&quot;</font></td></tr>

</table>

<p><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=5></td>

<td><font face="Helvetica" size="+1"><b>See Also</b></font></td></tr>

</table>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=55></td>

<td><font face="Times" size="+1">NWReadQueueJobEntry</font><br>
<font face="Times" size="+1">NWConvertPrintStructToQueueStruct</font></td></tr>

</table>

<p><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=5></td>

<td><font face="Helvetica" size="+1"><b>NWCreateQueue</b></font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=55></td>

<td><font face="Times" size="+1">This function creates a new queue in the bindery and file system of the specified file server.</font></td></tr>

</table>

<p><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=5></td>

<td><font face="Helvetica" size="+1"><b>Synopsis</b></font></td></tr>

</table>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=55></td>

<td><font face="Times" size="+1">#include &#34;netware/nwapi.h&#34;</font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=55></td>

<td nowrap><font face="Times" size="+1">int</font></td>

<td><font face="Times" size="+1">ccode;</font></td></tr>

<tr valign=top>

<td width=55></td>

<td nowrap><font face="Times" size="+1">uint16</font></td>

<td><font face="Times" size="+1">serverConnID;</font></td></tr>

<tr valign=top>

<td width=55></td>

<td nowrap><font face="Times" size="+1">char</font></td>

<td><font face="Times" size="+1">queueName</font><font face="Times" size="-1"><b>[NWMAX_QUEUE_NAME_LENGTH]</b></font><font face="Times" size="+1">;</font></td></tr>

<tr valign=top>

<td width=55></td>

<td nowrap><font face="Times" size="+1">uint16</font></td>

<td><font face="Times" size="+1">queueObjectType;</font></td></tr>

<tr valign=top>

<td width=55></td>

<td nowrap><font face="Times" size="+1">NWDirHandle_ts</font></td>

<td><font face="Times" size="+1">directoryHandle;</font></td></tr>

<tr valign=top>

<td width=55></td>

<td nowrap><font face="Times" size="+1">char</font></td>

<td><font face="Times" size="+1">queueSubdirectory</font><font face="Times" size="-1"><b>[NWMAX_QUEUE</b></font><br>
<img src="../Images/sp.gif" width=100 height=1><font face="Times" size="-1"><b>SUBDIR_LENGTH]</b></font><font face="Times" size="+1">;</font></td></tr>

<tr valign=top>

<td width=55></td>

<td nowrap><font face="Times" size="+1">uint32</font></td>

<td><font face="Times" size="+1">newQueueID;</font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=55></td>

<td><font face="Times" size="+1">ccode=<b>NWCreateQueue</b>( serverConnID, queueName, queueObjectType,</font><br>
<font face="Times" size="+1">directoryHandle, queueSubdirectory, &amp;newQueueID );</font></td></tr>

</table>

<p><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=5></td>

<td><font face="Helvetica" size="+1"><b>Input</b></font></td></tr>

</table>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=55></td>

<td><font face="Times" size="+1"><i>serverConnID</i> passes the file server connection ID.</font>

<p><font face="Times" size="+1"><i>queueName</i> passes a pointer to the name of queue to be created (48 characters).</font>

<p><font face="Times" size="+1"><i>queueObjectType</i> passes a number indicating the bindery object type for the new queue.</font>

<p><font face="Times" size="+1"><i>directoryHandle</i> passes the NetWare directory handle pointing to the directory in which the queue's property is to be created&nbsp; (0 if the queueSubdirectory parameter contains the full path).</font>

<p><font face="Times" size="+1"><i>queueSubdirectory</i> passes a pointer to the absolute path or a path relative to the NetWare directory handle that will contain the queue files (119 characters, stored in the Q_DIRECTORY property).</font>

<p><font face="Times" size="+1"><i>newQueueID</i> passes a pointer to the space allocated for the new queue ID number.</font></td></tr>

</table>

<p><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=5></td>

<td><font face="Helvetica" size="+1"><b>Output</b></font></td></tr>

</table>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=55></td>

<td><font face="Times" size="+1"><i>newQueueID</i> receives the new queue ID number.</font></td></tr>

</table>

<p><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=5></td>

<td><font face="Helvetica" size="+1"><b>Return Values</b></font></td></tr>

</table>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=58></td>

<td nowrap><font face="Times" size="+1">0</font></td>

<td><font face="Times" size="+1">Successful.</font></td></tr>

</table>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=55></td>

<td nowrap><font face="Times" size="+1">-1</font></td>

<td><font face="Times" size="+1">Unsuccessful.&nbsp; One of the following error codes is placed in NWErrno.</font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times" size="+1">0x99</font></td>

<td><font face="Times" size="+1">Directory Full</font></td></tr>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times" size="+1">0xFF</font></td>

<td><font face="Times" size="+1">Failure</font></td></tr>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times" size="+1">0xF5</font></td>

<td><font face="Times" size="+1">No Object Create Privilege</font></td></tr>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times" size="+1">0x30</font></td>

<td><font face="Times" size="+1">Invalid Connection ID</font></td></tr>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times" size="+1">0x9B</font></td>

<td><font face="Times" size="+1">Invalid Dir Handle</font></td></tr>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times" size="+1">0x98</font></td>

<td><font face="Times" size="+1">Volume Does Not Exist</font></td></tr>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times" size="+1">0xEE</font></td>

<td><font face="Times" size="+1">Queue Exists</font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=55></td>

<td><font face="Times" size="+1">See Appendix B for a complete listing of possible NetWare errors and a description of the four bytes in NWErrno.</font></td></tr>

</table>

<p><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=5></td>

<td><font face="Helvetica" size="+1"><b>Description</b></font></td></tr>

</table>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=55></td>

<td><font face="Times" size="+1">This function creates a queue in the bindery, using the type and name specified by the queueObjectType and queueName parameters.&nbsp; Novell has the following bindery object types defined for queues:</font>

<p><img src="../Images/sp.gif" width=50 height=1><font face="Times" size="+1">NWOT_PRINT_QUEUE</font><br>
<img src="../Images/sp.gif" width=50 height=1><font face="Times" size="+1">NWOT_ARCHIVE_QUEUE</font><br>
<img src="../Images/sp.gif" width=50 height=1><font face="Times" size="+1">NWOT_JOB_QUEUE</font>

<p><font face="Times" size="+1">This function also creates the Q_DIRECTORY property.&nbsp; The value for the Q_DIRECTORY property is determined by combining the directoryHandle and queueSubdirectory parameters.</font>

<p><font face="Times" size="+1">QMS will use the directory handle and directory path parameters to create a queue directory that holds the system files containing the queue itself and the job files related to the queue entries.&nbsp; The directory path SYS:SYSTEM is commonly used for the queue directory. QMS uses this directory to store queue files until they are serviced.</font>

<p><font face="Times" size="+1">Next, this function creates the following group properties:</font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times" size="+1"><img src="../Images/bullet1.gif" width=4 height=8 vspace=3></font></td>

<td><font face="Times" size="+1">Q_SERVERS</font></td></tr>

<tr valign=top>

<td width=105 height=4></td></tr>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times" size="+1"><img src="../Images/bullet1.gif" width=4 height=8 vspace=3></font></td>

<td><font face="Times" size="+1">Q_OPERATORS</font></td></tr>

<tr valign=top>

<td width=105 height=4></td></tr>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times" size="+1"><img src="../Images/bullet1.gif" width=4 height=8 vspace=3></font></td>

<td><font face="Times" size="+1">Q_USERS</font></td></tr>

</table>

<p><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=5></td>

<td><font face="Helvetica" size="+1"><b>Notes</b></font></td></tr>

</table>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=55></td>

<td><font face="Times" size="+1">Only SUPERVISOR or a bindery object that is security equivalent to&nbsp; SUPERVISOR can create a queue.</font></td></tr>

</table>

<p><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=5></td>

<td><font face="Helvetica" size="+1"><b>See Also</b></font></td></tr>

</table>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=55></td>

<td><font face="Times" size="+1">NWDestroyQueue</font></td></tr>

</table>

<p><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=5></td>

<td><font face="Helvetica" size="+1"><b>NWCreateQueueFile</b></font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=55></td>

<td><font face="Times" size="+1">This function creates a queue file.</font></td></tr>

</table>

<p><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=5></td>

<td><font face="Helvetica" size="+1"><b>Synopsis</b></font></td></tr>

</table>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=55></td>

<td><font face="Times" size="+1">#include &#34;netware/nwapi.h&#34;</font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=55></td>

<td nowrap><font face="Times" size="+1">int</font></td>

<td><font face="Times" size="+1">ccode;</font></td></tr>

<tr valign=top>

<td width=55></td>

<td nowrap><font face="Times" size="+1">uint16</font></td>

<td><font face="Times" size="+1">serverConnID;</font></td></tr>

<tr valign=top>

<td width=55></td>

<td nowrap><font face="Times" size="+1">uint32</font></td>

<td><font face="Times" size="+1">queueID;</font></td></tr>

<tr valign=top>

<td width=55></td>

<td nowrap><font face="Times" size="+1">NWQueueJobStruct_t</font></td>

<td><font face="Times" size="+1">jobStruct;</font></td></tr>

<tr valign=top>

<td width=55></td>

<td nowrap><font face="Times" size="+1">NWFileHandle_ta</font></td>

<td><font face="Times" size="+1">fileHandle;</font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=55></td>

<td><font face="Times" size="+1">ccode=<b>NWCreateQueueFile</b>( serverConnID, queueID, &amp;jobStruct, fileHandle );</font></td></tr>

</table>

<p><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=5></td>

<td><font face="Helvetica" size="+1"><b>Input</b></font></td></tr>

</table>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=55></td>

<td><font face="Times" size="+1"><i>serverConnID</i> passes the file server connection ID.</font>

<p><font face="Times" size="+1"><i>queueID</i> passes the bindery's object ID for the queue.</font>

<p><font face="Times" size="+1"><i>jobStruct</i> passes a pointer to the structure in which the information about the job is stored.&nbsp; (See Appendix A, &quot;NWQueueJobStruct _t Structure.&quot;)</font>

<p><font face="Times" size="+1"><i>fileHandle</i> passes a pointer to the file handle of the file to be created in the queue.</font></td></tr>

</table>

<p><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=5></td>

<td><font face="Helvetica" size="+1"><b>Output</b></font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=55></td>

<td><font face="Times" size="+1"><i>jobStruct</i> receives the completed job structure.&nbsp; (See Appendix A, &quot;NWQueueJobStruct_t Structure.&quot;)</font>

<p><font face="Times" size="+1"><i>fileHandle</i> receives the file handle of the job's associated file.&nbsp; (This file contains data pertaining to the job; for example, a print job file would contain the actual data to be printed.)</font></td></tr>

</table>

<p><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=5></td>

<td><font face="Helvetica" size="+1"><b>Return Values</b></font></td></tr>

</table>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=58></td>

<td nowrap><font face="Times" size="+1">0</font></td>

<td><font face="Times" size="+1">Successful.</font></td></tr>

</table>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=55></td>

<td nowrap><font face="Times" size="+1">-1</font></td>

<td><font face="Times" size="+1">Unsuccessful.&nbsp; One of the following error codes is placed in NWErrno.</font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times" size="+1">0x99</font></td>

<td><font face="Times" size="+1">Directory Full</font></td></tr>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times" size="+1">0xD7</font></td>

<td><font face="Times" size="+1">Queue Servicing</font></td></tr>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times" size="+1">0xD0</font></td>

<td><font face="Times" size="+1">Queue Error</font></td></tr>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times" size="+1">0xD8</font></td>

<td><font face="Times" size="+1">Queue Not Active</font></td></tr>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times" size="+1">0xD1</font></td>

<td><font face="Times" size="+1">No Queue</font></td></tr>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times" size="+1">0xDA</font></td>

<td><font face="Times" size="+1">Queue Halted</font></td></tr>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times" size="+1">0xD3</font></td>

<td><font face="Times" size="+1">No Queue Rights</font></td></tr>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times" size="+1">0xFC</font></td>

<td><font face="Times" size="+1">No Such Object</font></td></tr>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times" size="+1">0xD4</font></td>

<td><font face="Times" size="+1">Queue Full</font></td></tr>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times" size="+1">0xFF</font></td>

<td><font face="Times" size="+1">Failure</font></td></tr>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times" size="+1">0x30</font></td>

<td><font face="Times" size="+1">Invalid Connection ID</font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=55></td>

<td><font face="Times" size="+1">See Appendix B for a complete listing of possible NetWare errors and a description of the four bytes in NWErrno.</font></td></tr>

</table>

<p><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=5></td>

<td><font face="Helvetica" size="+1"><b>Description</b></font></td></tr>

</table>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=55></td>

<td><font face="Times" size="+1">This function allows a client to enter a new job in a queue.</font>

<p><font face="Times" size="+1">The following fields within the NWQueueJobStruct_t structure must be assigned values before this call can be made.&nbsp; (See Appendix A,</font><br>
<font face="Times" size="+1">&quot;NWQueueJobStruct_t Structure.&quot;)</font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=55></td>

<td nowrap><font face="Times" size="+1">targetServerID</font></td>

<td><font face="Times" size="+1">The objectID of the queue server or 0xFFFFFFFF for</font><br>
<font face="Times" size="+1">any server.&nbsp; The following example assigns</font><br>
<font face="Times" size="+1">0xB0000012 as the targetServerID:</font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=55></td>

<td><img src="../Images/sp.gif" width=152 height=1><font face="Times" size="+1">jobStruct.targetServerID = 0xB0000012;</font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=55></td>

<td nowrap><font face="Times" size="+1">targetExecutionTime</font></td>

<td><font face="Times" size="+1">The time you want the file processed.&nbsp; The field is a 6</font><br>
<font face="Times" size="+1">byte field with the following format: year, month, day,</font><br>
<font face="Times" size="+1">hour, minute, second.&nbsp; Use 0xFFFFFFFFFFFF for</font><br>
<font face="Times" size="+1">first opportunity.&nbsp; This example assigns May 1, 1991,</font><br>
<font face="Times" size="+1">9:30:10 am as the targetExecutionTime:</font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=55></td>

<td><img src="../Images/sp.gif" width=152 height=1><font face="Times" size="+1"><b>jobStruct.targetExecutionTime[0] = 91;</b></font><br>
<img src="../Images/sp.gif" width=152 height=1><font face="Times" size="+1">jobStruct.targetExecutionTime[1] = 5;</font><br>
<img src="../Images/sp.gif" width=152 height=1><font face="Times" size="+1">jobStruct.targetExecutionTime[2] = 1;</font><br>
<img src="../Images/sp.gif" width=152 height=1><font face="Times" size="+1">jobStruct.targetExecutionTime[3] = 9;</font><br>
<img src="../Images/sp.gif" width=152 height=1><font face="Times" size="+1">jobStruct.targetExecutionTime[4] = 30;</font><br>
<img src="../Images/sp.gif" width=152 height=1><font face="Times" size="+1">jobStruct.targetExecutionTime[5] = 10;</font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=55></td>

<td nowrap><font face="Times" size="+1">jobType</font></td>

<td><font face="Times" size="+1">The number representing the type of job serviced by</font><br>
<font face="Times" size="+1">the server; this number is server dependent.&nbsp; The</font><br>
<font face="Times" size="+1">following example assigns 0x00 as the jobType (0x00</font><br>
<font face="Times" size="+1">means the queue server does not use this field):</font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=55></td>

<td><img src="../Images/sp.gif" width=152 height=1><font face="Times" size="+1">jobStruct.jobType = 0;</font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=55></td>

<td nowrap><font face="Times" size="+1">jobControlFlags</font></td>

<td><font face="Times" size="+1">The control flag that has been assigned to the job.</font><br>
<font face="Times" size="+1">Use any of the following:</font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=55></td>

<td><img src="../Images/sp.gif" width=152 height=1><font face="Times" size="+1">NWCF_OPERATOR_HOLD</font><br>
<img src="../Images/sp.gif" width=152 height=1><font face="Times" size="+1">NWCF_USER_HOLD</font><br>
<img src="../Images/sp.gif" width=152 height=1><font face="Times" size="+1">NWCF_ENTRY_OPEN</font><br>
<img src="../Images/sp.gif" width=152 height=1><font face="Times" size="+1">NWCF_SERVICE_RESTART</font><br>
<img src="../Images/sp.gif" width=152 height=1><font face="Times" size="+1">NWCF_SERVICE_AUTO_START</font>

<p><img src="../Images/sp.gif" width=152 height=1><font face="Times" size="+1">The following example assigns NWCF_SERVICE_</font><br>
<img src="../Images/sp.gif" width=152 height=1><font face="Times" size="+1">RESTART:</font>

<p><img src="../Images/sp.gif" width=152 height=1><font face="Times" size="+1"><b>jobStruct.jobControlFlags =</b></font><br>
<img src="../Images/sp.gif" width=152 height=1><font face="Times" size="+1">NWCF_SERVICE_RESTART;</font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=55></td>

<td nowrap><font face="Times" size="+1">jobDescription</font></td>

<td><font face="Times" size="+1">A string containing the content or purpose of the job.</font><br>
<font face="Times" size="+1">The following example assigns &#34;Print Job&#34; as the job</font><br>
<font face="Times" size="+1">description:</font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=55></td>

<td><img src="../Images/sp.gif" width=152 height=1><font face="Times" size="+1"><b>strcpy(jobStruct.jobDescription,</b></font><br>
<img src="../Images/sp.gif" width=152 height=1><font face="Times" size="+1"><b>&#34;Print Job&#34;);</b></font>

<p><font face="Times" size="+1">The queueRecord field may need to be filled in.</font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times" size="+1"><img src="../Images/bullet1.gif" width=4 height=8 vspace=3></font></td>

<td><font face="Times" size="+1">If the file being submitted to the queue is a NetWare print job, the client must first allocate a printRecord and fill in the</font><br>
<font face="Times" size="+1">NWPrintRecord_t Structure.</font></td></tr>

<tr valign=top>

<td width=105 height=4></td></tr>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times" size="+1"><img src="../Images/bullet1.gif" width=4 height=8 vspace=3></font></td>

<td><font face="Times" size="+1">Use NWConvertPrintStructToQueueStruct to fill in the queueRecord with the printRecord information.&nbsp; Then NWCreateQueueFile can be called.</font></td></tr>

<tr valign=top>

<td width=105 height=4></td></tr>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times" size="+1"><img src="../Images/bullet1.gif" width=4 height=8 vspace=3></font></td>

<td><font face="Times" size="+1">If the client wants to verify the printRecord after making this call, use NWConvertQueueStructToPrintStruct to convert the</font><br>
<font face="Times" size="+1">queueRecord field back into the printRecord.</font></td></tr>

<tr valign=top>

<td width=105 height=4></td></tr>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times" size="+1"><img src="../Images/bullet1.gif" width=4 height=8 vspace=3></font></td>

<td><font face="Times" size="+1">If the file being submitted to the queue is not a NetWare print job and the queue server uses the queueRecord parameter, the queue server must provide its own function to fill in the queueRecord parameter.</font></td></tr>

<tr valign=top>

<td width=105 height=4></td></tr>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times" size="+1"><img src="../Images/bullet1.gif" width=4 height=8 vspace=3></font></td>

<td><font face="Times" size="+1">If the queue server does not use the queueRecord parameter, the parameter does not need to be filled in.</font></td></tr>

<tr valign=top>

<td width=105 height=4></td></tr>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times" size="+1"><img src="../Images/bullet1.gif" width=4 height=8 vspace=3></font></td>

<td><font face="Times" size="+1">The file server fills in all other fields within the jobStruct parameter and returns it to the requesting client.</font></td></tr>

<tr valign=top>

<td width=105 height=4></td></tr>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times" size="+1"><img src="../Images/bullet1.gif" width=4 height=8 vspace=3></font></td>

<td><font face="Times" size="+1">The job will not be serviced until the file is closed with</font><br>
<font face="Times" size="+1">NWCloseFileAndStartQueueJob.</font></td></tr>

</table>

<p><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=5></td>

<td><font face="Helvetica" size="+1"><b>Notes</b></font></td></tr>

</table>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=55></td>

<td><font face="Times" size="+1">This function can be used in conjunction with the NWReadQueueJobEntry function to change a portion of the job's entry record.&nbsp; However, if the target entry is already being serviced, NWChangeQueueJobEntry returns a Q_SERVICING error and makes no changes to the job's entry record.</font></td></tr>

</table>

<p><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=5></td>

<td><font face="Helvetica" size="+1"><b>See Also</b></font></td></tr>

</table>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=55></td>

<td><font face="Times" size="+1">NWChangeQueueJobEntry</font><br>
<font face="Times" size="+1">NWCloseFileAndAbortQueueJob</font><br>
<font face="Times" size="+1">NWCloseFileAndStartQueueJob</font><br>
<font face="Times" size="+1">NWConvertPrintStructToQueueStruct</font><br>
<font face="Times" size="+1">NWConvertQueueStructToPrintStruct</font><br>
<font face="Times" size="+1">NWRemoveJobFromQueue</font></td></tr>

</table>

<p><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=5></td>

<td><font face="Helvetica" size="+1"><b>NWDestroyQueue</b></font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=55></td>

<td><font face="Times" size="+1">This function deletes a queue.</font></td></tr>

</table>

<p><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=5></td>

<td><font face="Helvetica" size="+1"><b>Synopsis</b></font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=55></td>

<td><font face="Times" size="+1">#include &#34;netware/nwapi.h&#34;</font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=55></td>

<td nowrap><font face="Times" size="+1">int</font></td>

<td><font face="Times" size="+1">ccode;</font></td></tr>

<tr valign=top>

<td width=55></td>

<td nowrap><font face="Times" size="+1">uint16</font></td>

<td><font face="Times" size="+1">serverConnID;</font></td></tr>

<tr valign=top>

<td width=55></td>

<td nowrap><font face="Times" size="+1">uint32</font></td>

<td><font face="Times" size="+1">queueID;</font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=55></td>

<td><font face="Times" size="+1">ccode=<b>NWDestroyQueue</b>( serverConnID, queueID );</font></td></tr>

</table>

<p><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=5></td>

<td><font face="Helvetica" size="+1"><b>Input</b></font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=55></td>

<td><font face="Times" size="+1"><i>serverConnID</i> passes the file server connection ID.</font>

<p><font face="Times" size="+1"><i>queueID</i> passes the bindery object ID of the queue to be deleted.</font></td></tr>

</table>

<p><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=5></td>

<td><font face="Helvetica" size="+1"><b>Output</b></font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=55></td>

<td><font face="Times" size="+1">None.</font></td></tr>

</table>

<p><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=5></td>

<td><font face="Helvetica" size="+1"><b>Return Values</b></font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=55></td>

<td nowrap><font face="Times" size="+1">0</font></td>

<td><font face="Times" size="+1">Successful.</font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=55></td>

<td nowrap><font face="Times" size="+1">-1</font></td>

<td><font face="Times" size="+1">Unsuccessful.&nbsp; One of the following error codes is placed in NWErrno.</font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times" size="+1">0xFC</font></td>

<td><font face="Times" size="+1">No Such Object</font></td></tr>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times" size="+1">0xF4</font></td>

<td><font face="Times" size="+1">No Object Delete Privilege</font></td></tr>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times" size="+1">0x30</font></td>

<td><font face="Times" size="+1">Invalid Connection ID</font></td></tr>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times" size="+1">0xFF</font></td>

<td><font face="Times" size="+1">Failure</font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=55></td>

<td><font face="Times" size="+1">See Appendix B for a complete listing of possible NetWare errors and a description of the four bytes in NWErrno.</font></td></tr>

</table>

<p><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=5></td>

<td><font face="Helvetica" size="+1"><b>Description</b></font></td></tr>

</table>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=55></td>

<td><font face="Times" size="+1">This function destroys the queue specified by the queueID parameter.&nbsp; All active jobs are aborted, all servers are detached from the queue, and all jobs in the queue are destroyed and their associated files deleted.&nbsp; The queue object and its associated properties are removed from the bindery and the queue's subdirectory is deleted.</font></td></tr>

</table>

<p><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=5></td>

<td><font face="Helvetica" size="+1"><b>Notes</b></font></td></tr>

</table>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=55></td>

<td><font face="Times" size="+1">Only SUPERVISOR or a bindery object that is security equivalent to&nbsp; SUPERVISOR can destroy a queue.</font></td></tr>

</table>

<p><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=5></td>

<td><font face="Helvetica" size="+1"><b>See Also</b></font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=55></td>

<td><font face="Times" size="+1">NWCreateQueue</font></td></tr>

</table>

<p><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=5></td>

<td><font face="Helvetica" size="+1"><b>NWDetachQueueServerFromQueue</b></font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=55></td>

<td><font face="Times" size="+1">This function removes the calling client from the queue's list of active queue servers.</font></td></tr>

</table>

<p><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=5></td>

<td><font face="Helvetica" size="+1"><b>Synopsis</b></font></td></tr>

</table>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=55></td>

<td><font face="Times" size="+1">#include &#34;netware/nwapi.h&#34;</font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=55></td>

<td nowrap><font face="Times" size="+1">int</font></td>

<td><font face="Times" size="+1">ccode;</font></td></tr>

<tr valign=top>

<td width=55></td>

<td nowrap><font face="Times" size="+1">uint16</font></td>

<td><font face="Times" size="+1">serverConnID;</font></td></tr>

<tr valign=top>

<td width=55></td>

<td nowrap><font face="Times" size="+1">uint32</font></td>

<td><font face="Times" size="+1">queueID;</font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=55></td>

<td><font face="Times" size="+1">ccode=<b>NWDetachQueueServerFromQueue</b>( serverConnID, queueID );</font></td></tr>

</table>

<p><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=5></td>

<td><font face="Helvetica" size="+1"><b>Input</b></font></td></tr>

</table>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=55></td>

<td><font face="Times" size="+1"><i>serverConnID</i> passes the file server connection ID.</font>

<p><font face="Times" size="+1"><i>queueID</i> passes the bindery object ID of the queue from which the calling station is being detached.</font></td></tr>

</table>

<p><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=5></td>

<td><font face="Helvetica" size="+1"><b>Output</b></font></td></tr>

</table>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=55></td>

<td><font face="Times" size="+1">None.</font></td></tr>

</table>

<p><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=5></td>

<td><font face="Helvetica" size="+1"><b>Return Values</b></font></td></tr>

</table>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=58></td>

<td nowrap><font face="Times" size="+1">0</font></td>

<td><font face="Times" size="+1">Successful.</font></td></tr>

</table>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=55></td>

<td nowrap><font face="Times" size="+1">-1</font></td>

<td><font face="Times" size="+1">Unsuccessful.&nbsp; One of the following error codes is placed in NWErrno:</font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times" size="+1">0x99 (153)</font></td>

<td><font face="Times" size="+1">Directory Full</font></td></tr>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times" size="+1">0xD0 (208)</font></td>

<td><font face="Times" size="+1">Queue Error</font></td></tr>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times" size="+1">0xD1 (209)</font></td>

<td><font face="Times" size="+1">No Queue</font></td></tr>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times" size="+1">0xD2 (210)</font></td>

<td><font face="Times" size="+1">No Queue Server</font></td></tr>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times" size="+1">0xD3 (211)</font></td>

<td><font face="Times" size="+1">No Queue Rights</font></td></tr>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times" size="+1">0xD4 (212)</font></td>

<td><font face="Times" size="+1">Queue Full</font></td></tr>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times" size="+1">0xD5 (213)</font></td>

<td><font face="Times" size="+1">No Queue Job</font></td></tr>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times" size="+1">0xD6 (214)</font></td>

<td><font face="Times" size="+1">No Job Right</font></td></tr>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times" size="+1">0xD7 (215)</font></td>

<td><font face="Times" size="+1">Queue Servicing</font></td></tr>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times" size="+1">0xD8 (216)</font></td>

<td><font face="Times" size="+1">Queue Not Active</font></td></tr>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times" size="+1">0xD9 (217)</font></td>

<td><font face="Times" size="+1">Station Not Server</font></td></tr>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times" size="+1">0xDA (218)</font></td>

<td><font face="Times" size="+1">Queue Halted</font></td></tr>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times" size="+1">0xDB (219)</font></td>

<td><font face="Times" size="+1">Max. Queue Servers</font></td></tr>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times" size="+1">0xFF (255)</font></td>

<td><font face="Times" size="+1">Failure</font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=55></td>

<td><font face="Times" size="+1">See Appendix B for a complete listing of possible NetWare errors and a description of the four bytes in NWErrno.</font></td></tr>

</table>

<p><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=5></td>

<td><font face="Helvetica" size="+1"><b>Description</b></font></td></tr>

</table>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=55></td>

<td><font face="Times" size="+1">This function removes the requesting client from the queue's list of active queue servers.&nbsp; If the requesting client is servicing a job, that service is automatically aborted.</font></td></tr>

</table>

<p><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=5></td>

<td><font face="Helvetica" size="+1"><b>Notes</b></font></td></tr>

</table>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=55></td>

<td><font face="Times" size="+1">Only a workstation previously attached to the queue as a queue server can call this function.</font></td></tr>

</table>

<p><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=5></td>

<td><font face="Helvetica" size="+1"><b>See Also</b></font></td></tr>

</table>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=55></td>

<td><font face="Times" size="+1">NWAttachQueueServerToQueue</font><br>
<font face="Times" size="+1">NWReadQueueServerCurrentStatus</font><br>
<font face="Times" size="+1">NWSetQueueServerCurrentStatus</font></td></tr>

</table>

<p><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=5></td>

<td><font face="Helvetica" size="+1"><b>NWFinishServicingQueueJob</b></font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=55></td>

<td><font face="Times" size="+1">This function signals that a job has been completed successfully.</font></td></tr>

</table>

<p><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=5></td>

<td><font face="Helvetica" size="+1"><b>Synopsis</b></font></td></tr>

</table>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=55></td>

<td><font face="Times" size="+1">#include &#34;netware/nwapi.h&#34;</font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=55></td>

<td nowrap><font face="Times" size="+1">int</font></td>

<td><font face="Times" size="+1">ccode;</font></td></tr>

<tr valign=top>

<td width=55></td>

<td nowrap><font face="Times" size="+1">uint16</font></td>

<td><font face="Times" size="+1">serverConnID;</font></td></tr>

<tr valign=top>

<td width=55></td>

<td nowrap><font face="Times" size="+1">uint32</font></td>

<td><font face="Times" size="+1">queueID;</font></td></tr>

<tr valign=top>

<td width=55></td>

<td nowrap><font face="Times" size="+1">uint16</font></td>

<td><font face="Times" size="+1">jobNumber;</font></td></tr>

<tr valign=top>

<td width=55></td>

<td nowrap><font face="Times" size="+1">NWFileHandle_ta</font></td>

<td><font face="Times" size="+1">fileHandle;</font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=55></td>

<td><font face="Times" size="+1">ccode=<b>NWFinishServicingQueueJob</b>( serverConnID, queueID, jobNumber,</font><br>
<font face="Times" size="+1">fileHandle );</font></td></tr>

</table>

<p><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=5></td>

<td><font face="Helvetica" size="+1"><b>Input</b></font></td></tr>

</table>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=55></td>

<td><font face="Times" size="+1"><i>serverConnID</i> passes the file server connection ID.</font>

<p><font face="Times" size="+1"><i>queueID</i> passes the bindery object ID of the queue containing the job being finished.</font>

<p><font face="Times" size="+1"><i>jobNumber</i> passes the job number of the job being finished.</font>

<p><font face="Times" size="+1"><i>fileHandle</i> passes a pointer to the file handle for the file associated with the queue job.</font></td></tr>

</table>

<p><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=5></td>

<td><font face="Helvetica" size="+1"><b>Output</b></font></td></tr>

</table>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=55></td>

<td><font face="Times" size="+1">None.</font></td></tr>

</table>

<p><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=5></td>

<td><font face="Helvetica" size="+1"><b>Return Values</b></font></td></tr>

</table>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=58></td>

<td nowrap><font face="Times" size="+1">0</font></td>

<td><font face="Times" size="+1">Successful.</font></td></tr>

</table>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=55></td>

<td nowrap><font face="Times" size="+1">-1</font></td>

<td><font face="Times" size="+1">Unsuccessful.&nbsp; One of the following error codes is placed in NWErrno:</font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times" size="+1">0x99 (153)</font></td>

<td><font face="Times" size="+1">Directory Full</font></td></tr>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times" size="+1">0xD0 (208)</font></td>

<td><font face="Times" size="+1">Queue Error</font></td></tr>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times" size="+1">0xD1 (209)</font></td>

<td><font face="Times" size="+1">No Queue</font></td></tr>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times" size="+1">0xD2 (210)</font></td>

<td><font face="Times" size="+1">No Queue Server</font></td></tr>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times" size="+1">0xD3 (211)</font></td>

<td><font face="Times" size="+1">No Queue Rights</font></td></tr>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times" size="+1">0xD4 (212)</font></td>

<td><font face="Times" size="+1">Queue Full</font></td></tr>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times" size="+1">0xD5 (213)</font></td>

<td><font face="Times" size="+1">No Queue Job</font></td></tr>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times" size="+1">0xD6 (214)</font></td>

<td><font face="Times" size="+1">No Job Right</font></td></tr>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times" size="+1">0xD7 (215)</font></td>

<td><font face="Times" size="+1">Queue Servicing</font></td></tr>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times" size="+1">0xD8 (216)</font></td>

<td><font face="Times" size="+1">Queue Not Active</font></td></tr>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times" size="+1">0xD9 (217)</font></td>

<td><font face="Times" size="+1">Station Not Server</font></td></tr>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times" size="+1">0xDA (218)</font></td>

<td><font face="Times" size="+1">Queue Halted</font></td></tr>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times" size="+1">0xDB (219)</font></td>

<td><font face="Times" size="+1">Max. Queue Servers</font></td></tr>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times" size="+1">0xFF (255)</font></td>

<td><font face="Times" size="+1">Failure</font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=54></td>

<td nowrap><font face="Times" size="+1"><b>Note:</b></font></td>

<td><font face="Times" size="+1">Because this call uses NWCloseFile, it is possible to get</font><br>
<font face="Times" size="+1">NWErrno=0x001100xx.&nbsp; The 0x0011 indicates a file system error.&nbsp; See Appendix B for a complete listing of possible NetWare errors and a description of the four bytes in NWErrno.</font></td></tr>

</table>

<p><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=5></td>

<td><font face="Helvetica" size="+1"><b>Description</b></font></td></tr>

</table>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=55></td>

<td><font face="Times" size="+1">This function allows a queue server to signal the QMS that it has serviced a job successfully.&nbsp; The job entry is destroyed, and the job file is closed and deleted.</font>

<p><font face="Times" size="+1">The calling queue server's access rights to the queue server are restored to their original (login) values.</font></td></tr>

</table>

<p><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=5></td>

<td><font face="Helvetica" size="+1"><b>Notes</b></font></td></tr>

</table>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=55></td>

<td><font face="Times" size="+1">Only a queue server that has accepted a job to service can call this function.</font></td></tr>

</table>

<p><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=5></td>

<td><font face="Helvetica" size="+1"><b>See Also</b></font></td></tr>

</table>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=55></td>

<td><font face="Times" size="+1">NWAbortServicingQueueJob</font><br>
<font face="Times" size="+1">NWChangeToClientRights</font><br>
<font face="Times" size="+1">NWServiceQueueJob</font></td></tr>

</table>

<p><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=5></td>

<td><font face="Helvetica" size="+1"><b>NWGetQueueJobFileSize</b></font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=55></td>

<td><font face="Times" size="+1">This function returns the file size of the specified queue job.</font></td></tr>

</table>

<p><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=5></td>

<td><font face="Helvetica" size="+1"><b>Synopsis</b></font></td></tr>

</table>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=55></td>

<td><font face="Times" size="+1">#include &#34;netware/nwapi.h&#34;</font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=55></td>

<td nowrap><font face="Times" size="+1">int</font></td>

<td><font face="Times" size="+1">ccode;</font></td></tr>

<tr valign=top>

<td width=55></td>

<td nowrap><font face="Times" size="+1">uint16</font></td>

<td><font face="Times" size="+1">serverConnID;</font></td></tr>

<tr valign=top>

<td width=55></td>

<td nowrap><font face="Times" size="+1">uint32</font></td>

<td><font face="Times" size="+1">queueID;</font></td></tr>

<tr valign=top>

<td width=55></td>

<td nowrap><font face="Times" size="+1">uint16</font></td>

<td><font face="Times" size="+1">jobNumber;</font></td></tr>

<tr valign=top>

<td width=55></td>

<td nowrap><font face="Times" size="+1">uint32</font></td>

<td><font face="Times" size="+1">fileSize;</font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=55></td>

<td><font face="Times" size="+1">ccode=<b>NWGetQueueJobFileSize</b>( serverConnID, queueID, jobNumber,</font><br>
<font face="Times" size="+1">&amp;fileSize );</font></td></tr>

</table>

<p><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=5></td>

<td><font face="Helvetica" size="+1"><b>Input</b></font></td></tr>

</table>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=55></td>

<td><font face="Times" size="+1"><i>serverConnID</i> passes the file server connection ID.</font>

<p><font face="Times" size="+1"><i>queueID</i> passes the bindery object ID of the queue to which the job is associated.</font>

<p><font face="Times" size="+1"><i>jobNumber</i> passes the number of the job for which the information will be obtained.</font>

<p><font face="Times" size="+1"><i>fileSize</i> passes a pointer to the space allocated for the file size.</font></td></tr>

</table>

<p><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=5></td>

<td><font face="Helvetica" size="+1"><b>Output</b></font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=55></td>

<td><font face="Times" size="+1"><i>fileSize</i> receives the file size.</font></td></tr>

</table>

<p><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=5></td>

<td><font face="Helvetica" size="+1"><b>Return Values</b></font></td></tr>

</table>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=58></td>

<td nowrap><font face="Times" size="+1">0</font></td>

<td><font face="Times" size="+1">Successful.</font></td></tr>

</table>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=55></td>

<td nowrap><font face="Times" size="+1">-1</font></td>

<td><font face="Times" size="+1">Unsuccessful.&nbsp; One of the following error codes is placed in NWErrno:</font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times" size="+1">0x99 (153)</font></td>

<td><font face="Times" size="+1">Directory Full</font></td></tr>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times" size="+1">0xD0 (208)</font></td>

<td><font face="Times" size="+1">Queue Error</font></td></tr>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times" size="+1">0xD1 (209)</font></td>

<td><font face="Times" size="+1">No Queue</font></td></tr>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times" size="+1">0xD2 (210)</font></td>

<td><font face="Times" size="+1">No Queue Server</font></td></tr>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times" size="+1">0xD3 (211)</font></td>

<td><font face="Times" size="+1">No Queue Rights</font></td></tr>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times" size="+1">0xD4 (212)</font></td>

<td><font face="Times" size="+1">Queue Full</font></td></tr>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times" size="+1">0xD5 (213)</font></td>

<td><font face="Times" size="+1">No Queue Job</font></td></tr>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times" size="+1">0xD6 (214)</font></td>

<td><font face="Times" size="+1">No Job Right</font></td></tr>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times" size="+1">0xD7 (215)</font></td>

<td><font face="Times" size="+1">Queue Servicing</font></td></tr>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times" size="+1">0xD8 (216)</font></td>

<td><font face="Times" size="+1">Queue Not Active</font></td></tr>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times" size="+1">0xD9 (217)</font></td>

<td><font face="Times" size="+1">Station Not Server</font></td></tr>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times" size="+1">0xDA (218)</font></td>

<td><font face="Times" size="+1">Queue Halted</font></td></tr>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times" size="+1">0xDB (219)</font></td>

<td><font face="Times" size="+1">Max. Queue Servers</font></td></tr>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times" size="+1">0xFF (255)</font></td>

<td><font face="Times" size="+1">Failure</font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=55></td>

<td><font face="Times" size="+1">See Appendix B for a complete listing of possible NetWare errors and a description of the four bytes in NWErrno.</font></td></tr>

</table>

<p><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=5></td>

<td><font face="Helvetica" size="+1"><b>NWGetQueueJobList</b></font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=55></td>

<td><font face="Times" size="+1">This function returns a list of all jobs associated with a given queue.</font></td></tr>

</table>

<p><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=5></td>

<td><font face="Helvetica" size="+1"><b>Synopsis</b></font></td></tr>

</table>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=55></td>

<td><font face="Times" size="+1">#include &#34;netware/nwapi.h&#34;</font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=55></td>

<td nowrap><font face="Times" size="+1">int</font></td>

<td><font face="Times" size="+1">ccode;</font></td></tr>

<tr valign=top>

<td width=55></td>

<td nowrap><font face="Times" size="+1">uint16</font></td>

<td><font face="Times" size="+1">serverConnID;</font></td></tr>

<tr valign=top>

<td width=55></td>

<td nowrap><font face="Times" size="+1">uint32</font></td>

<td><font face="Times" size="+1">queueID;</font></td></tr>

<tr valign=top>

<td width=55></td>

<td nowrap><font face="Times" size="+1">uint16</font></td>

<td><font face="Times" size="+1">numberOfJobsInQueue;</font></td></tr>

<tr valign=top>

<td width=55></td>

<td nowrap><font face="Times" size="+1">uint16</font></td>

<td><font face="Times" size="+1">listOfJobNumbers</font><font face="Times" size="-1"><b>[NWMAX_NUMBER_OF_</b></font><br>
<img src="../Images/sp.gif" width=100 height=1><font face="Times" size="-1"><b>JOB_NUMBERS]</b></font><font face="Times" size="+1">;</font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=55></td>

<td><font face="Times" size="+1">ccode=<b>NWGetQueueJobList</b>( serverConnID, queueID,</font><br>
<font face="Times" size="+1">&amp;numberOfJobsInQueue, listOfJobNumbers );</font></td></tr>

</table>

<p><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=5></td>

<td><font face="Helvetica" size="+1"><b>Input</b></font></td></tr>

</table>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=55></td>

<td><font face="Times" size="+1"><i>serverConnID</i> passes the file server connection ID.</font>

<p><font face="Times" size="+1"><i>queueID</i> passes the bindery object ID of the queue whose job list is being reported.</font>

<p><font face="Times" size="+1"><i>numberOfJobsInQueue</i> passes a pointer to the space allocated for the number of jobs in the queue.</font>

<p><font face="Times" size="+1"><i>listOfJobNumbers</i> passes a pointer to the array allocated for the job numbers.</font></td></tr>

</table>

<p><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=5></td>

<td><font face="Helvetica" size="+1"><b>Output</b></font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=55></td>

<td><font face="Times" size="+1"><i>numberOfJobsInQueue</i> receives the number of jobs currently in the Queue (0 - 250).</font>

<p><font face="Times" size="+1"><i>listOfJobNumbers</i> receives the job numbers of all the jobs in the queue (0 - 250 numbers possible).</font></td></tr>

</table>

<p><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=5></td>

<td><font face="Helvetica" size="+1"><b>Return Values</b></font></td></tr>

</table>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=58></td>

<td nowrap><font face="Times" size="+1">0</font></td>

<td><font face="Times" size="+1">Successful.</font></td></tr>

</table>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=55></td>

<td nowrap><font face="Times" size="+1">-1</font></td>

<td><font face="Times" size="+1">Unsuccessful.&nbsp; One of the following error codes is placed in NWErrno:</font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times" size="+1">0x99 (153)</font></td>

<td><font face="Times" size="+1">Directory Full</font></td></tr>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times" size="+1">0xD0 (208)</font></td>

<td><font face="Times" size="+1">Queue Error</font></td></tr>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times" size="+1">0xD1 (209)</font></td>

<td><font face="Times" size="+1">No Queue</font></td></tr>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times" size="+1">0xD2 (210)</font></td>

<td><font face="Times" size="+1">No Queue Server</font></td></tr>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times" size="+1">0xD3 (211)</font></td>

<td><font face="Times" size="+1">No Queue Rights</font></td></tr>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times" size="+1">0xD4 (212)</font></td>

<td><font face="Times" size="+1">Queue Full</font></td></tr>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times" size="+1">0xD5 (213)</font></td>

<td><font face="Times" size="+1">No Queue Job</font></td></tr>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times" size="+1">0xD6 (214)</font></td>

<td><font face="Times" size="+1">No Job Right</font></td></tr>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times" size="+1">0xD7 (215)</font></td>

<td><font face="Times" size="+1">Queue Servicing</font></td></tr>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times" size="+1">0xD8 (216)</font></td>

<td><font face="Times" size="+1">Queue Not Active</font></td></tr>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times" size="+1">0xD9 (217)</font></td>

<td><font face="Times" size="+1">Station Not Server</font></td></tr>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times" size="+1">0xDA (218)</font></td>

<td><font face="Times" size="+1">Queue Halted</font></td></tr>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times" size="+1">0xDB (219)</font></td>

<td><font face="Times" size="+1">Max. Queue Servers</font></td></tr>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times" size="+1">0xFF (255)</font></td>

<td><font face="Times" size="+1">Failure</font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=55></td>

<td><font face="Times" size="+1">See Appendix B for a complete listing of possible NetWare errors and a description of the four bytes in NWErrno.</font></td></tr>

</table>

<p><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=5></td>

<td><font face="Helvetica" size="+1"><b>Description</b></font></td></tr>

</table>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=55></td>

<td><font face="Times" size="+1">This function allows a program to get a list of all the jobs currently in a queue.&nbsp; When used in conjunction with the NWReadQueueJobEntry function, this function allows an application to retrieve information about all the jobs in a given queue.&nbsp; Because the QMS environment is multithreaded, however, the positioning, number and type of jobs in the queue can change between consecutive calls.</font>

<p><font face="Times" size="+1">This function allows a workstation to determine how many jobs are in the queue at a particular instant and the job number of each.&nbsp; If a subsequent call to read information about a job in the queue fails with a NO_Q_JOB error, the requesting workstation can assume that either the job was deleted from the queue or its service was completed.</font></td></tr>

</table>

<p><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=5></td>

<td><font face="Helvetica" size="+1"><b>Notes</b></font></td></tr>

</table>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=55></td>

<td><font face="Times" size="+1">The workstation making this call must be security equivalent to one of the objects listed in the queue's Q_USERS or Q_OPERATORS group properties.</font></td></tr>

</table>

<p><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=5></td>

<td><font face="Helvetica" size="+1"><b>See Also</b></font></td></tr>

</table>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=55></td>

<td><font face="Times" size="+1">NWChangeQueueJobEntry</font><br>
<font face="Times" size="+1">NWChangeQueueJobPosition</font><br>
<font face="Times" size="+1">NWReadQueueJobEntry</font></td></tr>

</table>

<p><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=5></td>

<td><font face="Helvetica" size="+1"><b>NWReadQueueCurrentStatus</b></font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=55></td>

<td><font face="Times" size="+1">This function returns the current status of a queue.</font></td></tr>

</table>

<p><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=5></td>

<td><font face="Helvetica" size="+1"><b>Synopsis</b></font></td></tr>

</table>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=55></td>

<td><font face="Times" size="+1">#include &#34;netware/nwapi.h&#34;</font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=55></td>

<td nowrap><font face="Times" size="+1">int</font></td>

<td><font face="Times" size="+1">ccode;</font></td></tr>

<tr valign=top>

<td width=55></td>

<td nowrap><font face="Times" size="+1">uint16</font></td>

<td><font face="Times" size="+1">serverConnID;</font></td></tr>

<tr valign=top>

<td width=55></td>

<td nowrap><font face="Times" size="+1">uint32</font></td>

<td><font face="Times" size="+1">queueID;</font></td></tr>

<tr valign=top>

<td width=55></td>

<td nowrap><font face="Times" size="+1">uint8</font></td>

<td><font face="Times" size="+1">queueStatus;</font></td></tr>

<tr valign=top>

<td width=55></td>

<td nowrap><font face="Times" size="+1">uint16</font></td>

<td><font face="Times" size="+1">numberOfJobsInQueue;</font></td></tr>

<tr valign=top>

<td width=55></td>

<td nowrap><font face="Times" size="+1">uint16</font></td>

<td><font face="Times" size="+1">numberOfServers;</font></td></tr>

<tr valign=top>

<td width=55></td>

<td nowrap><font face="Times" size="+1">uint32</font></td>

<td><font face="Times" size="+1">serverObjectIDList</font><font face="Times" size="-1"><b>[NWMAX_NUMBER_</b></font><br>
<img src="../Images/sp.gif" width=100 height=1><font face="Times" size="-1"><b>OF_SERVER_OBJECT_IDS]</b></font><font face="Times" size="+1">;</font></td></tr>

<tr valign=top>

<td width=55></td>

<td nowrap><font face="Times" size="+1">uint16</font></td>

<td><font face="Times" size="+1">clientConnIDList</font><font face="Times" size="-1"><b>[NWMAX_NUMBER_</b></font><br>
<img src="../Images/sp.gif" width=100 height=1><font face="Times" size="-1"><b>OF_SERVER_CONN_NUMBERS]</b></font><font face="Times" size="+1">;</font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=55></td>

<td><font face="Times" size="+1">ccode=<b>NWReadQueueCurrentStatus</b>( serverConnID, queueID,</font><br>
<font face="Times" size="+1">&amp;queueStatus,&amp;numberOfJobsInQueue, &amp;numberOfServers,</font><br>
<font face="Times" size="+1">serverObjectIDList, clientConnIDList );</font></td></tr>

</table>

<p><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=5></td>

<td><font face="Helvetica" size="+1"><b>Input</b></font></td></tr>

</table>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=55></td>

<td><font face="Times" size="+1"><i>serverConnID</i> passes the file server connection ID.</font>

<p><font face="Times" size="+1"><i>queueID</i> passes the bindery object ID of the queue for which the status is being obtained.</font>

<p><font face="Times" size="+1"><i>queueStatus</i> passes a pointer to the space allocated for the queue status.</font>

<p><font face="Times" size="+1"><i>numberOfJobsInQueue</i> passes a pointer to the space allocated for the number of jobs in the queue.</font>

<p><font face="Times" size="+1"><i>numberOfServers</i> passes a pointer to the space allocated for the number of attached queue servers.</font>

<p><font face="Times" size="+1"><i>serverObjectIDList</i> passes a pointer to an array allocated for queue server object IDs associated with the numberOfServers parameter.</font>

<p><font face="Times" size="+1"><i>clientConnIDList</i> passes a pointer to an array allocated for clientConnIDs corresponding to the servers returned by the serverObjectIDList parameter.</font></td></tr>

</table>

<p><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=5></td>

<td><font face="Helvetica" size="+1"><b>Output</b></font></td></tr>

</table>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=55></td>

<td><font face="Times" size="+1"><i>queueStatus</i> receives the status of the specified queue.&nbsp; (See Appendix A, &quot;Queue Status Flags.&quot;)</font>

<p><font face="Times" size="+1"><i>numberOfJobsInQueue</i> receives the number of jobs currently in the queue.</font>

<p><font face="Times" size="+1"><i>numberOfServers</i> receives the number of attached queue servers.</font>

<p><font face="Times" size="+1"><i>serverObjectIDList</i> receives an array of server IDs associated with the</font><br>
<font face="Times" size="+1">numberOfServers parameter.</font>

<p><font face="Times" size="+1"><i>clientConnIDList</i> receives an array of clientConnIDs corresponding to the servers returned by the serverObjectIDList parameter.</font></td></tr>

</table>

<p><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=5></td>

<td><font face="Helvetica" size="+1"><b>Return Values</b></font></td></tr>

</table>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=58></td>

<td nowrap><font face="Times" size="+1">0</font></td>

<td><font face="Times" size="+1">Successful.</font></td></tr>

</table>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=55></td>

<td nowrap><font face="Times" size="+1">-1</font></td>

<td><font face="Times" size="+1">Unsuccessful.&nbsp; One of the following error codes is placed in NWErrno:</font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times" size="+1">0xFC</font></td>

<td><font face="Times" size="+1">No Such Object</font></td></tr>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times" size="+1">0x30</font></td>

<td><font face="Times" size="+1">Invalid Connection ID</font></td></tr>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times" size="+1">0xFF</font></td>

<td><font face="Times" size="+1">Failure</font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=55></td>

<td><font face="Times" size="+1">See Appendix B for a complete listing of possible NetWare errors and a description of the four bytes in NWErrno.</font></td></tr>

</table>

<p><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=5></td>

<td><font face="Helvetica" size="+1"><b>Description</b></font></td></tr>

</table>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=55></td>

<td><font face="Times" size="+1">This function is a queue server function which reads the current status of the specified queue.&nbsp; The queueStatus parameter indicates the overall status of the queue.&nbsp; (See Appendix A, &quot;Queue Status Flags.&quot;)</font>

<p><font face="Times" size="+1">The numberOfJobsInQueue parameter contains a count of the number of jobs currently in the queue, 0 to 250.</font>

<p><font face="Times" size="+1">The numberOfServers parameter contains a count of the number of queue servers currently attached to service this queue, 0 to 25.</font>

<p><font face="Times" size="+1">The serverObjectIDList and clientConnIDList parameters list queue servers currently servicing the queue by the queue server's&nbsp; objectID and the queue server's current workstation attachment (clientConnID).</font></td></tr>

</table>

<p><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=5></td>

<td><font face="Helvetica" size="+1"><b>Notes</b></font></td></tr>

</table>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=55></td>

<td><font face="Times" size="+1">Workstations making this call must be security equivalent to one of the objects listed in the queue's Q_USERS or Q_OPERATORS group properties.</font></td></tr>

</table>

<p><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=5></td>

<td><font face="Helvetica" size="+1"><b>See Also</b></font></td></tr>

</table>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=55></td>

<td><font face="Times" size="+1">NWAttachQueueServerToQueue</font><br>
<font face="Times" size="+1">NWDetachQueueServerFromQueue</font><br>
<font face="Times" size="+1">NWReadQueueServerCurrentStatus</font><br>
<font face="Times" size="+1">NWSetQueueCurrentStatus</font><br>
<font face="Times" size="+1">NWSetQueueServerCurrentStatus</font></td></tr>

</table>

<p><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=5></td>

<td><font face="Helvetica" size="+1"><b>NWReadQueueJobEntry</b></font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=55></td>

<td><font face="Times" size="+1">This function retrieves information about a specified queue job.</font></td></tr>

</table>

<p><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=5></td>

<td><font face="Helvetica" size="+1"><b>Synopsis</b></font></td></tr>

</table>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=55></td>

<td><font face="Times" size="+1">#include &#34;netware/nwapi.h&#34;</font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=55></td>

<td nowrap><font face="Times" size="+1">int</font></td>

<td><font face="Times" size="+1">ccode;</font></td></tr>

<tr valign=top>

<td width=55></td>

<td nowrap><font face="Times" size="+1">uint16</font></td>

<td><font face="Times" size="+1">serverConnID;</font></td></tr>

<tr valign=top>

<td width=55></td>

<td nowrap><font face="Times" size="+1">uint32</font></td>

<td><font face="Times" size="+1">queueID;</font></td></tr>

<tr valign=top>

<td width=55></td>

<td nowrap><font face="Times" size="+1">uint16 j</font></td>

<td><font face="Times" size="+1">obNumber;</font></td></tr>

<tr valign=top>

<td width=55></td>

<td nowrap><font face="Times" size="+1">NWQueueJobStruct_t</font></td>

<td><font face="Times" size="+1">jobStruct;</font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=55></td>

<td><font face="Times" size="+1">ccode=<b>NWReadQueueJobEntry</b>( serverConnID, queueID, jobNumber,</font><br>
<font face="Times" size="+1">&amp;jobStruct );</font></td></tr>

</table>

<p><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=5></td>

<td><font face="Helvetica" size="+1"><b>Input</b></font></td></tr>

</table>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=55></td>

<td><font face="Times" size="+1"><i>serverConnID</i> passes the file server connection ID.</font>

<p><font face="Times" size="+1"><i>queueID</i> passes the bindery object ID of the queue associated with the queue job being read.</font>

<p><font face="Times" size="+1"><i>jobNumber</i> passes the number of the job being read.</font>

<p><font face="Times" size="+1"><i>jobStruct</i> passes a pointer to the structure (NWQueueJobStruct_t) allocated for queue job information.</font></td></tr>

</table>

<p><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=5></td>

<td><font face="Helvetica" size="+1"><b>Output</b></font></td></tr>

</table>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=55></td>

<td><font face="Times" size="+1"><i>jobStruct</i> receives the structure containing the queue job information. (See Appendix A, &quot;NWQueueJobStruct_t Structure.&quot;)</font></td></tr>

</table>

<p><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=5></td>

<td><font face="Helvetica" size="+1"><b>Return Values</b></font></td></tr>

</table>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=58></td>

<td nowrap><font face="Times" size="+1">0</font></td>

<td><font face="Times" size="+1">Successful.</font></td></tr>

</table>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=55></td>

<td nowrap><font face="Times" size="+1">-1</font></td>

<td><font face="Times" size="+1">Unsuccessful.&nbsp; One of the following error codes is placed in NWErrno:</font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times" size="+1">0xD0</font></td>

<td><font face="Times" size="+1">Queue Error</font></td></tr>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times" size="+1">0xFC</font></td>

<td><font face="Times" size="+1">No Such Object</font></td></tr>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times" size="+1">0xD1</font></td>

<td><font face="Times" size="+1">No Queue</font></td></tr>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times" size="+1">0x30</font></td>

<td><font face="Times" size="+1">Invalid Connection ID</font></td></tr>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times" size="+1">0xD3</font></td>

<td><font face="Times" size="+1">No Queue Rights</font></td></tr>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times" size="+1">0xFF</font></td>

<td><font face="Times" size="+1">Failure</font></td></tr>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times" size="+1">0xD5</font></td>

<td><font face="Times" size="+1">No Queue Job</font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=55></td>

<td><font face="Times" size="+1">See Appendix B for a complete listing of possible NetWare errors and a description of the four bytes in NWErrno.</font></td></tr>

</table>

<p><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=5></td>

<td><font face="Helvetica" size="+1"><b>Description</b></font></td></tr>

</table>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=55></td>

<td><font face="Times" size="+1">This function allows an application to retrieve information about a job from a queue.&nbsp; The job's full 256-byte record is returned. ( See &quot;NWQueueJobStruct_t structure&quot; in Appendix A.)</font></td></tr>

</table>

<p><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=5></td>

<td><font face="Helvetica" size="+1"><b>Notes</b></font></td></tr>

</table>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=55></td>

<td><font face="Times" size="+1">Workstations making this call must be security equivalent to one of the objects listed in the queue's Q_USER or Q_OPERATORS group properties.</font></td></tr>

</table>

<p><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=5></td>

<td><font face="Helvetica" size="+1"><b>See Also</b></font></td></tr>

</table>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=55></td>

<td><font face="Times" size="+1">NWChangeQueueJobEntry</font><br>
<font face="Times" size="+1">NWChangeQueueJobPosition</font><br>
<font face="Times" size="+1">NWCreateQueueFile</font><br>
<font face="Times" size="+1">NWGetQueueJobList</font></td></tr>

</table>

<p><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=5></td>

<td><font face="Helvetica" size="+1"><b>NWReadQueueServerCurrentStatus</b></font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=55></td>

<td><font face="Times" size="+1">This function reads the current status of a queue server.</font></td></tr>

</table>

<p><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=5></td>

<td><font face="Helvetica" size="+1"><b>Synopsis</b></font></td></tr>

</table>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=55></td>

<td><font face="Times" size="+1">#include &#34;netware/nwapi.h&#34;</font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=55></td>

<td nowrap><font face="Times" size="+1">int</font></td>

<td><font face="Times" size="+1">ccode;</font></td></tr>

<tr valign=top>

<td width=55></td>

<td nowrap><font face="Times" size="+1">uint16</font></td>

<td><font face="Times" size="+1">serverConnID;</font></td></tr>

<tr valign=top>

<td width=55></td>

<td nowrap><font face="Times" size="+1">uint32</font></td>

<td><font face="Times" size="+1">queueID;</font></td></tr>

<tr valign=top>

<td width=55></td>

<td nowrap><font face="Times" size="+1">uint32</font></td>

<td><font face="Times" size="+1">queueServerID;</font></td></tr>

<tr valign=top>

<td width=55></td>

<td nowrap><font face="Times" size="+1">uint16</font></td>

<td><font face="Times" size="+1">queueServerClientConnID;</font></td></tr>

<tr valign=top>

<td width=55></td>

<td nowrap><font face="Times" size="+1">void</font></td>

<td><font face="Times" size="+1">serverStatusRecord</font><font face="Times" size="-1"><b>[NWMAX_SERVER_STATUS_</b></font><br>
<img src="../Images/sp.gif" width=100 height=1><font face="Times" size="-1"><b>RECORD_LENGTH]</b></font><font face="Times" size="+1">;</font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=55></td>

<td><font face="Times" size="+1">ccode=<b>NWReadQueueServerCurrentStatus</b>( serverConnID, queueID,&nbsp; queueServerID, queueServerClientConnID, serverStatusRecord );</font></td></tr>

</table>

<p><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=5></td>

<td><font face="Helvetica" size="+1"><b>Input</b></font></td></tr>

</table>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=55></td>

<td><font face="Times" size="+1"><i>serverConnID</i> passes the file server connection ID.</font>

<p><font face="Times" size="+1"><i>queueID</i> passes the bindery object ID of the queue being affected.</font>

<p><font face="Times" size="+1"><i>queueServerID</i> passes the bindery object ID of the queue server whose current status is being read.</font>

<p><font face="Times" size="+1"><i>queueServerClientConnID</i> passes the connection number of the queue server being read.</font>

<p><font face="Times" size="+1"><i>serverStatusRecord</i> passes a pointer to the buffer allocated for the status of the specified queue server.</font></td></tr>

</table>

<p><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=5></td>

<td><font face="Helvetica" size="+1"><b>Output</b></font></td></tr>

</table>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=55></td>

<td><font face="Times" size="+1"><i>serverStatusRecord</i> receives the status of the specified queue server (64 bytes).</font></td></tr>

</table>

<p><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=5></td>

<td><font face="Helvetica" size="+1"><b>Return Values</b></font></td></tr>

</table>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=58></td>

<td nowrap><font face="Times" size="+1">0</font></td>

<td><font face="Times" size="+1">Successful.</font></td></tr>

</table>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=55></td>

<td nowrap><font face="Times" size="+1">-1</font></td>

<td><font face="Times" size="+1">Unsuccessful.&nbsp; One of the following error codes is placed in NWErrno:</font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times" size="+1">0x99 (153)</font></td>

<td><font face="Times" size="+1">Directory Full</font></td></tr>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times" size="+1">0xD0 (208)</font></td>

<td><font face="Times" size="+1">Queue Error</font></td></tr>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times" size="+1">0xD1 (209)</font></td>

<td><font face="Times" size="+1">No Queue</font></td></tr>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times" size="+1">0xD2 (210)</font></td>

<td><font face="Times" size="+1">No Queue Server</font></td></tr>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times" size="+1">0xD3 (211)</font></td>

<td><font face="Times" size="+1">No Queue Rights</font></td></tr>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times" size="+1">0xD4 (212)</font></td>

<td><font face="Times" size="+1">Queue Full</font></td></tr>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times" size="+1">0xD5 (213)</font></td>

<td><font face="Times" size="+1">No Queue Job</font></td></tr>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times" size="+1">0xD6 (214)</font></td>

<td><font face="Times" size="+1">No Job Right</font></td></tr>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times" size="+1">0xD7 (215)</font></td>

<td><font face="Times" size="+1">Queue Servicing</font></td></tr>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times" size="+1">0xD8 (216)</font></td>

<td><font face="Times" size="+1">Queue Not Active</font></td></tr>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times" size="+1">0xD9 (217)</font></td>

<td><font face="Times" size="+1">Station Not Server</font></td></tr>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times" size="+1">0xDA (218)</font></td>

<td><font face="Times" size="+1">Queue Halted</font></td></tr>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times" size="+1">0xDB (219)</font></td>

<td><font face="Times" size="+1">Max. Queue Servers</font></td></tr>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times" size="+1">0xFF (255)</font></td>

<td><font face="Times" size="+1">Failure</font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=55></td>

<td><font face="Times" size="+1">See Appendix B for a complete listing of possible NetWare errors and a description of the four bytes in NWErrno.</font></td></tr>

</table>

<p><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=5></td>

<td><font face="Helvetica" size="+1"><b>Description</b></font></td></tr>

</table>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=55></td>

<td><font face="Times" size="+1">This function allows a station to read the current status of a queue server.&nbsp; The QMS maintains a 64-byte status record for each queue server attached to a queue.</font>

<p><font face="Times" size="+1">The QMS does not interpret the contents of the status record.&nbsp; The record contains information important to the calling application.&nbsp; We recommend that the first 4 bytes of this record contain an estimated price for the given server to complete a &#34;standard&#34; job.</font></td></tr>

</table>

<p><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=5></td>

<td><font face="Helvetica" size="+1"><b>Notes</b></font></td></tr>

</table>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=55></td>

<td><font face="Times" size="+1">Workstations making this call must be security equivalent to one of the objects listed in the queue's Q_USER or Q_OPERATORS group properties.</font></td></tr>

</table>

<p><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=5></td>

<td><font face="Helvetica" size="+1"><b>See Also</b></font></td></tr>

</table>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=55></td>

<td><font face="Times" size="+1">NWSetQueueServerCurrentStatus</font></td></tr>

</table>

<p><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=5></td>

<td><font face="Helvetica" size="+1"><b>NWRemoveJobFromQueue</b></font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=55></td>

<td><font face="Times" size="+1">This function removes a job from a queue.</font></td></tr>

</table>

<p><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=5></td>

<td><font face="Helvetica" size="+1"><b>Synopsis</b></font></td></tr>

</table>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=55></td>

<td><font face="Times" size="+1">#include &#34;netware/nwapi.h&#34;</font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=55></td>

<td nowrap><font face="Times" size="+1">int</font></td>

<td><font face="Times" size="+1">ccode;</font></td></tr>

<tr valign=top>

<td width=55></td>

<td nowrap><font face="Times" size="+1">uint16</font></td>

<td><font face="Times" size="+1">serverConnID;</font></td></tr>

<tr valign=top>

<td width=55></td>

<td nowrap><font face="Times" size="+1">uint32</font></td>

<td><font face="Times" size="+1">queueID;</font></td></tr>

<tr valign=top>

<td width=55></td>

<td nowrap><font face="Times" size="+1">uint16</font></td>

<td><font face="Times" size="+1">jobNumber;</font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=55></td>

<td><font face="Times" size="+1">ccode=<b>NWRemoveJobFromQueue</b>( serverConnID, queueID, jobNumber );</font></td></tr>

</table>

<p><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=5></td>

<td><font face="Helvetica" size="+1"><b>Input</b></font></td></tr>

</table>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=55></td>

<td><font face="Times" size="+1"><i>serverConnID</i> passes the file server connection ID.</font>

<p><font face="Times" size="+1"><i>queueID</i> passes the bindery object ID of the queue where the job to be removed is located.</font>

<p><font face="Times" size="+1"><i>jobNumber</i> passes the number of the job being removed.</font></td></tr>

</table>

<p><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=5></td>

<td><font face="Helvetica" size="+1"><b>Output</b></font></td></tr>

</table>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=55></td>

<td><font face="Times" size="+1">None.</font></td></tr>

</table>

<p><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=5></td>

<td><font face="Helvetica" size="+1"><b>Return Values</b></font></td></tr>

</table>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=58></td>

<td nowrap><font face="Times" size="+1">0</font></td>

<td><font face="Times" size="+1">Successful.</font></td></tr>

</table>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=55></td>

<td nowrap><font face="Times" size="+1">-1</font></td>

<td><font face="Times" size="+1">Unsuccessful.&nbsp; One of the following error codes is placed in NWErrno:</font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times" size="+1">0x99 (153)</font></td>

<td><font face="Times" size="+1">Directory Full</font></td></tr>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times" size="+1">0xD0 (208)</font></td>

<td><font face="Times" size="+1">Queue Error</font></td></tr>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times" size="+1">0xD1 (209)</font></td>

<td><font face="Times" size="+1">No Queue</font></td></tr>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times" size="+1">0xD2 (210)</font></td>

<td><font face="Times" size="+1">No Queue Server</font></td></tr>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times" size="+1">0xD3 (211)</font></td>

<td><font face="Times" size="+1">No Queue Rights</font></td></tr>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times" size="+1">0xD4 (212)</font></td>

<td><font face="Times" size="+1">Queue Full</font></td></tr>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times" size="+1">0xD5 (213)</font></td>

<td><font face="Times" size="+1">No Queue Job</font></td></tr>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times" size="+1">0xD6 (214)</font></td>

<td><font face="Times" size="+1">No Job Right</font></td></tr>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times" size="+1">0xD7 (215)</font></td>

<td><font face="Times" size="+1">Queue Servicing</font></td></tr>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times" size="+1">0xD8 (216)</font></td>

<td><font face="Times" size="+1">Queue Not Active</font></td></tr>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times" size="+1">0xD9 (217)</font></td>

<td><font face="Times" size="+1">Station Not Server</font></td></tr>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times" size="+1">0xDA (218)</font></td>

<td><font face="Times" size="+1">Queue Halted</font></td></tr>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times" size="+1">0xDB (219)</font></td>

<td><font face="Times" size="+1">Max. Queue Servers</font></td></tr>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times" size="+1">0xFF (255)</font></td>

<td><font face="Times" size="+1">Failure</font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=55></td>

<td><font face="Times" size="+1">See Appendix B for a complete listing of possible NetWare errors and a description of the four bytes in NWErrno.</font></td></tr>

</table>

<p><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=5></td>

<td><font face="Helvetica" size="+1"><b>Description</b></font></td></tr>

</table>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=55></td>

<td><font face="Times" size="+1">This function allows the workstation to remove a job from a queue.&nbsp; The jobNumber parameter contains the job number returned by the QMS when the job was created.&nbsp; The job number can also be obtained by using the</font><br>
<font face="Times" size="+1">NWGetQueueJobList function.</font>

<p><font face="Times" size="+1">The specified job is removed from the queue, and the job file is closed and deleted.&nbsp; If the job is being serviced, the service is aborted.&nbsp; Further I/O requests made to the job's queue file return an ILLEGAL_FILE_HANDLE error.</font></td></tr>

</table>

<p><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=5></td>

<td><font face="Helvetica" size="+1"><b>Notes</b></font></td></tr>

</table>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=55></td>

<td><font face="Times" size="+1">Both the job's creator and an operator can call this function.</font></td></tr>

</table>

<p><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=5></td>

<td><font face="Helvetica" size="+1"><b>See Also</b></font></td></tr>

</table>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=55></td>

<td><font face="Times" size="+1">NWChangeQueueJobEntry</font><br>
<font face="Times" size="+1">NWChangeQueueJobPosition</font><br>
<font face="Times" size="+1">NWCreateQueueFile</font><br>
<font face="Times" size="+1">NWGetQueueJobList</font><br>
<font face="Times" size="+1">NWReadQueueJobEntry</font></td></tr>

</table>

<p><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=5></td>

<td><font face="Helvetica" size="+1"><b>NWRestoreQueueServerRights</b></font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=55></td>

<td><font face="Times" size="+1">This function restores a server's own identity after it has assumed its client's rights.</font></td></tr>

</table>

<p><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=5></td>

<td><font face="Helvetica" size="+1"><b>Synopsis</b></font></td></tr>

</table>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=55></td>

<td><font face="Times" size="+1">#include &#34;netware/nwapi.h&#34;</font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=55></td>

<td nowrap><font face="Times" size="+1">int</font></td>

<td><font face="Times" size="+1">ccode;</font></td></tr>

<tr valign=top>

<td width=55></td>

<td nowrap><font face="Times" size="+1">uint16</font></td>

<td><font face="Times" size="+1">serverConnID;</font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=55></td>

<td><font face="Times" size="+1">ccode=<b>NWRestoreQueueServerRights</b>( serverConnID );</font></td></tr>

</table>

<p><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=5></td>

<td><font face="Helvetica" size="+1"><b>Input</b></font></td></tr>

</table>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=55></td>

<td><font face="Times" size="+1"><i>serverConnID</i> passes the file server's connection ID.</font></td></tr>

</table>

<p><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=5></td>

<td><font face="Helvetica" size="+1"><b>Output</b></font></td></tr>

</table>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=55></td>

<td><font face="Times" size="+1">None.</font></td></tr>

</table>

<p><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=5></td>

<td><font face="Helvetica" size="+1"><b>Return Values</b></font></td></tr>

</table>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=58></td>

<td nowrap><font face="Times" size="+1">0</font></td>

<td><font face="Times" size="+1">Successful.</font></td></tr>

</table>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=55></td>

<td nowrap><font face="Times" size="+1">-1</font></td>

<td><font face="Times" size="+1">Unsuccessful.&nbsp; One of the following error codes is placed in NWErrno:</font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times" size="+1">0x99 (153)</font></td>

<td><font face="Times" size="+1">Directory Full</font></td></tr>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times" size="+1">0xD0 (208)</font></td>

<td><font face="Times" size="+1">Queue Error</font></td></tr>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times" size="+1">0xD1 (209)</font></td>

<td><font face="Times" size="+1">No Queue</font></td></tr>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times" size="+1">0xD2 (210)</font></td>

<td><font face="Times" size="+1">No Queue Server</font></td></tr>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times" size="+1">0xD3 (211)</font></td>

<td><font face="Times" size="+1">No Queue Rights</font></td></tr>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times" size="+1">0xD4 (212)</font></td>

<td><font face="Times" size="+1">Queue Full</font></td></tr>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times" size="+1">0xD5 (213)</font></td>

<td><font face="Times" size="+1">No Queue Job</font></td></tr>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times" size="+1">0xD6 (214)</font></td>

<td><font face="Times" size="+1">No Job Right</font></td></tr>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times" size="+1">0xD7 (215)</font></td>

<td><font face="Times" size="+1">Queue Servicing</font></td></tr>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times" size="+1">0xD8 (216)</font></td>

<td><font face="Times" size="+1">Queue Not Active</font></td></tr>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times" size="+1">0xD9 (217)</font></td>

<td><font face="Times" size="+1">Station Not Server</font></td></tr>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times" size="+1">0xDA (218)</font></td>

<td><font face="Times" size="+1">Queue Halted</font></td></tr>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times" size="+1">0xDB (219)</font></td>

<td><font face="Times" size="+1">Max. Queue Servers</font></td></tr>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times" size="+1">0xFF (255)</font></td>

<td><font face="Times" size="+1">Failure</font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=55></td>

<td><font face="Times" size="+1">See Appendix B for a complete listing of possible NetWare errors and a description of the four bytes in NWErrno.</font></td></tr>

</table>

<p><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=5></td>

<td><font face="Helvetica" size="+1"><b>Description</b></font></td></tr>

</table>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=55></td>

<td><font face="Times" size="+1">This function allows a queue server to restore its own identity after it has assumed its client's identity using the NWChangeToClientRights function.&nbsp; The queue server's login user identification and associated security equivalence list are restored to its original values.</font>

<p><font face="Times" size="+1">This function does not change any of the path mappings (directory bases) held by the queue server.&nbsp; However, access rights to those directories are adjusted to reflect the rights the queue server has in those directories.</font>

<p><font face="Times" size="+1">If the queue server has changed some of its path mappings as part of its efforts to service the queue job, the queue server must restore those directory bases.</font>

<p><font face="Times" size="+1">Files opened using the client's rights before this function is called continue to be accessible with the client's rights.&nbsp; Files opened after this function is called are accessible only with rights of the queue server.</font></td></tr>

</table>

<p><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=5></td>

<td><font face="Helvetica" size="+1"><b>Notes</b></font></td></tr>

</table>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=55></td>

<td><font face="Times" size="+1">Only queue servers that have previously changed their identity using the NWChangeToClientRights function can call this function.</font></td></tr>

</table>

<p><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=5></td>

<td><font face="Helvetica" size="+1"><b>See Also</b></font></td></tr>

</table>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=55></td>

<td><font face="Times" size="+1">NWChangeToClientRights</font></td></tr>

</table>

<p><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=5></td>

<td><font face="Helvetica" size="+1"><b>NWServiceQueueJob</b></font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=55></td>

<td><font face="Times" size="+1">This function allows a queue server to select a new job for servicing.</font></td></tr>

</table>

<p><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=5></td>

<td><font face="Helvetica" size="+1"><b>Synopsis</b></font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=55></td>

<td><font face="Times" size="+1">#include &#34;netware/nwapi.h&#34;</font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=55></td>

<td nowrap><font face="Times" size="+1">int</font></td>

<td><font face="Times" size="+1">ccode;</font></td></tr>

<tr valign=top>

<td width=55></td>

<td nowrap><font face="Times" size="+1">uint16</font></td>

<td><font face="Times" size="+1">serverConnID;</font></td></tr>

<tr valign=top>

<td width=55></td>

<td nowrap><font face="Times" size="+1">uint32</font></td>

<td><font face="Times" size="+1">queueID;</font></td></tr>

<tr valign=top>

<td width=55></td>

<td nowrap><font face="Times" size="+1">uint16</font></td>

<td><font face="Times" size="+1">targetJobType;</font></td></tr>

<tr valign=top>

<td width=55></td>

<td nowrap><font face="Times" size="+1">NWQueueJobStruct_t</font></td>

<td><font face="Times" size="+1">jobStruct;</font></td></tr>

<tr valign=top>

<td width=55></td>

<td nowrap><font face="Times" size="+1">NWFileHandle_ta</font></td>

<td><font face="Times" size="+1">fileHandle;</font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=55></td>

<td><font face="Times" size="+1">ccode=<b>NWServiceQueueJob</b>( serverConnID, queueID, targetJobType,</font><br>
<font face="Times" size="+1">&amp;jobStruct, fileHandle );</font></td></tr>

</table>

<p><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=5></td>

<td><font face="Helvetica" size="+1"><b>Input</b></font></td></tr>

</table>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=55></td>

<td><font face="Times" size="+1"><i>serverConnID</i> passes the file server connection ID.</font>

<p><font face="Times" size="+1"><i>queueID</i> passes the bindery object ID of the queue whose jobs are being serviced.</font>

<p><font face="Times" size="+1"><i>targetJobType</i> passes the type of the job to be serviced.</font>

<p><font face="Times" size="+1"><i>jobStruct</i> passes a pointer to the job record of the next available job returned by the QMS.&nbsp; (See Appendix A, &quot;NWQueueJobStruct_t Structure.&quot;)</font>

<p><font face="Times" size="+1"><i>fileHandle</i> passes a pointer to the file handle for the file associated with the job to be serviced.</font></td></tr>

</table>

<p><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=5></td>

<td><font face="Helvetica" size="+1"><b>Return Values</b></font></td></tr>

</table>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=58></td>

<td nowrap><font face="Times" size="+1">0</font></td>

<td><font face="Times" size="+1">Successful.</font></td></tr>

</table>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=55></td>

<td nowrap><font face="Times" size="+1">-1</font></td>

<td><font face="Times" size="+1">Unsuccessful.&nbsp; One of the following error codes is placed in NWErrno:</font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times" size="+1">0x99 (153)</font></td>

<td><font face="Times" size="+1">Directory Full</font></td></tr>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times" size="+1">0xD0 (208)</font></td>

<td><font face="Times" size="+1">Queue Error</font></td></tr>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times" size="+1">0xD1 (209)</font></td>

<td><font face="Times" size="+1">No Queue</font></td></tr>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times" size="+1">0xD2 (210)</font></td>

<td><font face="Times" size="+1">No Queue Server</font></td></tr>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times" size="+1">0xD3 (211)</font></td>

<td><font face="Times" size="+1">No Queue Rights</font></td></tr>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times" size="+1">0xD4 (212)</font></td>

<td><font face="Times" size="+1">Queue Full</font></td></tr>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times" size="+1">0xD5 (213)</font></td>

<td><font face="Times" size="+1">No Queue Job</font></td></tr>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times" size="+1">0xD6 (214)</font></td>

<td><font face="Times" size="+1">No Job Right</font></td></tr>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times" size="+1">0xD7 (215)</font></td>

<td><font face="Times" size="+1">Queue Servicing</font></td></tr>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times" size="+1">0xD8 (216)</font></td>

<td><font face="Times" size="+1">Queue Not Active</font></td></tr>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times" size="+1">0xD9 (217)</font></td>

<td><font face="Times" size="+1">Station Not Server</font></td></tr>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times" size="+1">0xDA (218)</font></td>

<td><font face="Times" size="+1">Queue Halted</font></td></tr>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times" size="+1">0xDB (219)</font></td>

<td><font face="Times" size="+1">Max. Queue Servers</font></td></tr>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times" size="+1">0xFF (255)</font></td>

<td><font face="Times" size="+1">Failure</font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=55></td>

<td><font face="Times" size="+1">See Appendix B for a complete listing of possible NetWare errors and a description of the four bytes in NWErrno.</font></td></tr>

</table>

<p><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=5></td>

<td><font face="Helvetica" size="+1"><b>Description</b></font></td></tr>

</table>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=55></td>

<td><font face="Times" size="+1">This function allows a queue server to select a new job for servicing.</font></td></tr>

</table>

<p><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=5></td>

<td><font face="Helvetica" size="+1"><b>Notes</b></font></td></tr>

</table>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=55></td>

<td><font face="Times" size="+1">The requesting client must have previously established itself as a queue server for the target queue.</font></td></tr>

</table>

<p><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=5></td>

<td><font face="Helvetica" size="+1"><b>See Also</b></font></td></tr>

</table>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=55></td>

<td><font face="Times" size="+1">NWAbortServicingQueueJob</font><br>
<font face="Times" size="+1">NWAttachQueueServerToQueue</font><br>
<font face="Times" size="+1">NWCreateQueueFile</font><br>
<font face="Times" size="+1">NWFinishServicingQueueJob</font></td></tr>

</table>

<p><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=5></td>

<td><font face="Helvetica" size="+1"><b>NWSetQueueCurrentStatus</b></font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=55></td>

<td><font face="Times" size="+1">This function modifies a queue's status.</font></td></tr>

</table>

<p><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=5></td>

<td><font face="Helvetica" size="+1"><b>Synopsis</b></font></td></tr>

</table>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=55></td>

<td><font face="Times" size="+1">#include &#34;netware/nwapi.h&#34;</font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=55></td>

<td nowrap><font face="Times" size="+1">int</font></td>

<td><font face="Times" size="+1">ccode;</font></td></tr>

<tr valign=top>

<td width=55></td>

<td nowrap><font face="Times" size="+1">uint16</font></td>

<td><font face="Times" size="+1">serverConnID;</font></td></tr>

<tr valign=top>

<td width=55></td>

<td nowrap><font face="Times" size="+1">uint32</font></td>

<td><font face="Times" size="+1">queueID;</font></td></tr>

<tr valign=top>

<td width=55></td>

<td nowrap><font face="Times" size="+1">uint8</font></td>

<td><font face="Times" size="+1">queueStatus;</font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=55></td>

<td><font face="Times" size="+1">ccode=<b>NWSetQueueCurrentStatus</b>( serverConnID, queueID, queueStatus );</font></td></tr>

</table>

<p><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=5></td>

<td><font face="Helvetica" size="+1"><b>Input</b></font></td></tr>

</table>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=55></td>

<td><font face="Times" size="+1"><i>serverConnID</i> passes the file server connection ID.</font>

<p><font face="Times" size="+1"><i>queueID</i> passes the bindery object ID of the queue whose status is being updated.</font>

<p><font face="Times" size="+1"><i>queueStatus</i> passes the control byte that determines the new status.&nbsp; (See Appendix A, &quot;Queue Status Flags.&quot;)</font></td></tr>

</table>

<p><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=5></td>

<td><font face="Helvetica" size="+1"><b>Output</b></font></td></tr>

</table>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=55></td>

<td><font face="Times" size="+1">None.</font></td></tr>

</table>

<p><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=5></td>

<td><font face="Helvetica" size="+1"><b>Return Values</b></font></td></tr>

</table>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=58></td>

<td nowrap><font face="Times" size="+1">0</font></td>

<td><font face="Times" size="+1">Successful.</font></td></tr>

</table>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=55></td>

<td nowrap><font face="Times" size="+1">-1</font></td>

<td><font face="Times" size="+1">Unsuccessful.&nbsp; One of the following error codes is placed in NWErrno:</font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times" size="+1">0xD3</font></td>

<td><font face="Times" size="+1">No Queue Rights</font></td></tr>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times" size="+1">0xFC</font></td>

<td><font face="Times" size="+1">No Such Object</font></td></tr>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times" size="+1">0x30</font></td>

<td><font face="Times" size="+1">Invalid Connection ID</font></td></tr>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times" size="+1">0xFF</font></td>

<td><font face="Times" size="+1">Failure</font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=55></td>

<td><font face="Times" size="+1">See Appendix B for a complete listing of possible NetWare errors and a description of the four bytes in NWErrno.</font></td></tr>

</table>

<p><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=5></td>

<td><font face="Helvetica" size="+1"><b>Description</b></font></td></tr>

</table>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=55></td>

<td><font face="Times" size="+1">This function allows the operator to control the addition of jobs and servers to the queue.</font></td></tr>

</table>

<p><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=5></td>

<td><font face="Helvetica" size="+1"><b>Notes</b></font></td></tr>

</table>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=55></td>

<td><font face="Times" size="+1">The client making this call must be logged in as one of the objects listed in the Q_OPERATORS property.&nbsp; The requesting client can become a queue operator by specifying its objectID when creating the queue (NWCreateQueue) or by adding its objectID with NWCreateProperty (see the Bindery Services chapter).</font></td></tr>

</table>

<p><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=5></td>

<td><font face="Helvetica" size="+1"><b>See Also</b></font></td></tr>

</table>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=55></td>

<td><font face="Times" size="+1">NWAttachQueueServerToQueue</font><br>
<font face="Times" size="+1">NWCreateQueue</font><br>
<font face="Times" size="+1">NWDetachQueueServerFromQueue</font><br>
<font face="Times" size="+1">NWReadQueueCurrentStatus</font></td></tr>

</table>

<p><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=5></td>

<td><font face="Helvetica" size="+1"><b>NWSetQueueServerCurrentStatus</b></font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=55></td>

<td><font face="Times" size="+1">This function updates QMS's copy of a server's status record.</font></td></tr>

</table>

<p><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=5></td>

<td><font face="Helvetica" size="+1"><b>Synopsis</b></font></td></tr>

</table>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=55></td>

<td><font face="Times" size="+1">#include &#34;netware/nwapi.h&#34;</font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=55></td>

<td nowrap><font face="Times" size="+1">int</font></td>

<td><font face="Times" size="+1">ccode;</font></td></tr>

<tr valign=top>

<td width=55></td>

<td nowrap><font face="Times" size="+1">uint16</font></td>

<td><font face="Times" size="+1">serverConnID;</font></td></tr>

<tr valign=top>

<td width=55></td>

<td nowrap><font face="Times" size="+1">uint32</font></td>

<td><font face="Times" size="+1">queueID;</font></td></tr>

<tr valign=top>

<td width=55></td>

<td nowrap><font face="Times" size="+1">void</font></td>

<td><font face="Times" size="+1">serverStatusRecord</font><font face="Times" size="-1"><b>[NWMAX_SERVER_</b></font><br>
<img src="../Images/sp.gif" width=51 height=1><font face="Times" size="-1"><b>STATUS_RECORD_LENGTH]</b></font><font face="Times" size="+1">;</font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=55></td>

<td><font face="Times" size="+1">ccode=<b>NWSetQueueServerCurrentStatus</b>( serverConnID, queueID,</font><br>
<font face="Times" size="+1">serverStatusRecord );</font></td></tr>

</table>

<p><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=5></td>

<td><font face="Helvetica" size="+1"><b>Input</b></font></td></tr>

</table>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=55></td>

<td><font face="Times" size="+1"><i>serverConnID</i> passes the file server connection ID.</font>

<p><font face="Times" size="+1"><i>queueID</i> passes the bindery object ID of the queue to which the specified queue server is attached.</font>

<p><font face="Times" size="+1"><i>serverStatusRecord</i> passes a pointer to the buffer containing the new status record of the queue server (64 bytes).</font></td></tr>

</table>

<p><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=5></td>

<td><font face="Helvetica" size="+1"><b>Output</b></font></td></tr>

</table>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=55></td>

<td><font face="Times" size="+1">None.</font></td></tr>

</table>

<p><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=5></td>

<td><font face="Helvetica" size="+1"><b>Return Values</b></font></td></tr>

</table>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=58></td>

<td nowrap><font face="Times" size="+1">0</font></td>

<td><font face="Times" size="+1">Successful.</font></td></tr>

</table>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=55></td>

<td nowrap><font face="Times" size="+1">-1</font></td>

<td><font face="Times" size="+1">Unsuccessful.&nbsp; One of the following error codes is placed in NWErrno:</font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times" size="+1">0x99 (153)</font></td>

<td><font face="Times" size="+1">Directory Full</font></td></tr>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times" size="+1">0xD0 (208)</font></td>

<td><font face="Times" size="+1">Queue Error</font></td></tr>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times" size="+1">0xD1 (209)</font></td>

<td><font face="Times" size="+1">No Queue</font></td></tr>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times" size="+1">0xD2 (210)</font></td>

<td><font face="Times" size="+1">No Queue Server</font></td></tr>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times" size="+1">0xD3 (211)</font></td>

<td><font face="Times" size="+1">No Queue Rights</font></td></tr>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times" size="+1">0xD4 (212)</font></td>

<td><font face="Times" size="+1">Queue Full</font></td></tr>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times" size="+1">0xD5 (213)</font></td>

<td><font face="Times" size="+1">No Queue Job</font></td></tr>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times" size="+1">0xD6 (214)</font></td>

<td><font face="Times" size="+1">No Job Right</font></td></tr>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times" size="+1">0xD7 (215)</font></td>

<td><font face="Times" size="+1">Queue Servicing</font></td></tr>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times" size="+1">0xD8 (216)</font></td>

<td><font face="Times" size="+1">Queue Not Active</font></td></tr>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times" size="+1">0xD9 (217)</font></td>

<td><font face="Times" size="+1">Station Not Server</font></td></tr>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times" size="+1">0xDA (218)</font></td>

<td><font face="Times" size="+1">Queue Halted</font></td></tr>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times" size="+1">0xDB (219)</font></td>

<td><font face="Times" size="+1">Max. Queue Servers</font></td></tr>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times" size="+1">0xFF (255)</font></td>

<td><font face="Times" size="+1">Failure</font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=55></td>

<td><font face="Times" size="+1">See Appendix B for a complete listing of possible NetWare errors and a description of the four bytes in NWErrno.</font></td></tr>

</table>

<p><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=5></td>

<td><font face="Helvetica" size="+1"><b>Description</b></font></td></tr>

</table>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=55></td>

<td><font face="Times" size="+1">The QMS does not interpret the contents of the status record.&nbsp; The record contains information important to the calling application only.&nbsp; We recommend that the first 4 bytes of this record contain an estimated price for the given server to complete a &#34;standard&#34; job.</font></td></tr>

</table>

<p><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=5></td>

<td><font face="Helvetica" size="+1"><b>Notes</b></font></td></tr>

</table>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=55></td>

<td><font face="Times" size="+1">Only workstations that have previously been attached to the queue as a queue server can make this call.</font></td></tr>

</table>

<p><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=5></td>

<td><font face="Helvetica" size="+1"><b>See Also</b></font></td></tr>

</table>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=55></td>

<td><font face="Times" size="+1">NWReadQueueServerCurrentStatus</font></td></tr>

</table>



<p>

</body>
</html>
